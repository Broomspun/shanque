<?php
 goto ZtRvV; X0XCC: function activity_coupon_consume($couponid, $recid, $store_id) { goto ICMLk; oGg0E: return error(-1, "\xe8\xaf\245\xe9\227\250\345\xba\x97\346\x97\xa0\346\263\225\344\275\xbf\xe7\224\250"); goto dfijL; ZwDfm: $vs0XZ = !($coupon_info["\x73\157\x75\x72\x63\x65"] == "\62"); goto avDOI; vpPH5: r2u3x: goto DXbCq; AQfWH: return error(-1, "\xe6\262\xa1\xe6\x9c\x89\xe6\x8c\x87\345\256\232\347\232\204\345\215\241\xe5\210\270\344\277\xa1\xe6\x81\257"); goto A0H5_; SMmy2: P6bMh: goto dcr9a; A6hTM: Vs9Ct: goto y1WOp; ClNFW: return error(-1, "\345\215\xa1\345\210\270\346\264\273\345\x8a\xa8\345\260\x9a\xe6\x9c\252\345\xbc\x80\345\xa7\213"); goto bODSK; wFb_F: $coupon_record = pdo_get("\x73\164\157\162\x65\170\x5f\x63\x6f\165\160\x6f\x6e\137\x72\145\x63\x6f\x72\144", array("\151\x64" => $recid, "\x73\164\141\x74\x75\x73" => "\x31")); goto oR8k3; vAxLR: $status = $coupon_api->ConsumeCode(array("\x63\157\x64\x65" => $coupon_record["\x63\x6f\144\145"])); goto lPu70; bdxe2: DP3dZ: goto gQGcY; X_MYz: return error(-1, "\xe5\x8d\241\345\210\270\xe6\xb4\273\xe5\x8a\xa8\xe5\260\x9a\346\x9c\252\345\xbc\200\xe5\247\213"); goto kFuZ7; XdroN: if ($uouEP) { goto WZQp1; } goto oGg0E; stkhN: return true; goto SEjZv; xDtrR: $sHZzo = empty($location_id_list); goto Zx5w7; hvBjg: $starttime = strtotime(date("\x59\55\x6d\55\x64", $coupon_record["\x61\144\144\164\x69\x6d\x65"])) + $date_info["\x64\145\141\144\154\x69\156\x65"] * 86400; goto o6rkE; y1WOp: $update = array("\x73\164\x61\x74\165\x73" => 2, "\165\x73\x65\x74\151\155\145" => TIMESTAMP, "\x63\x6c\x65\162\x6b\x5f\x6e\141\155\x65" => $clerk_name, "\x63\x6c\145\x72\x6b\137\x69\x64" => intval($clerk_id), "\143\x6c\x65\162\x6b\137\164\171\x70\145" => $clerk_type, "\x73\164\157\x72\x65\137\x69\144" => $store_id); goto kj3KX; rRSUZ: if (strtotime(str_replace("\x2e", "\x2d", $date_info["\x74\151\155\x65\x5f\154\151\x6d\151\x74\137\145\156\144"])) < strtotime(date("\131\x2d\x6d\x2d\144"))) { goto rCMPl; } goto GOjzI; pwMuc: zTKyy: goto qqJV0; DXbCq: gdySk: goto ZwDfm; frhMh: goto jf02Q; goto RkBcW; whji4: if ($date_info["\164\151\x6d\x65\x5f\x74\x79\x70\x65"] == "\61") { goto b2170; } goto hvBjg; ops17: $coupon_api = new coupon($_W["\141\143\151\x64"]); goto vAxLR; gQGcY: $date_info = iunserializer($coupon_info["\x64\x61\x74\x65\137\151\x6e\146\x6f"]); goto whji4; JmXCB: if ($h52n1) { goto W5ViL; } goto AQfWH; W8sEy: hO706: goto ClNFW; avDOI: if ($vs0XZ) { goto Vs9Ct; } goto RZHPF; mJ31K: Bxjwu: goto A6hTM; RkBcW: AvAer: goto X_MYz; aTzgG: $uid = $coupon_record["\x75\x69\x64"]; goto TA0D7; ofORE: b2170: goto FtCS1; dcr9a: $coupon_info = activity_get_coupon_info($couponid); goto p3pph; KIXcM: if ($S2iaL) { goto Bxjwu; } goto EMy0f; p3pph: $h52n1 = !empty($coupon_info); goto JmXCB; A0H5_: W5ViL: goto aTzgG; ICMLk: global $_W, $_GPC; goto dwoYX; Cbiey: if ($endtime < strtotime(date("\131\55\155\x2d\x64"))) { goto zTKyy; } goto frhMh; Zx5w7: if ($sHZzo) { goto DP3dZ; } goto h5Xym; lPu70: $S2iaL = !is_error($status); goto KIXcM; TA0D7: $location_id_list = $coupon_info["\x6c\157\x63\x61\164\151\x6f\x6e\x5f\x69\x64\x5f\154\151\163\164"]; goto xDtrR; oR8k3: $AWXKe = !empty($coupon_record); goto JfAX5; h5Xym: $uouEP = in_array($store_id, array_keys($location_id_list)); goto XdroN; qqJV0: return error(-1, "\xe5\215\241\xe5\x88\270\346\264\xbb\xe5\212\xa8\345\xb7\262\347\xbb\217\347\xbb\223\346\x9d\237"); goto wXLYC; gtR5M: goto gdySk; goto ofORE; bODSK: goto r2u3x; goto mO2WO; IGyRm: $clerk_id = $_W["\x75\x73\x65\162"]["\x63\x6c\x65\x72\x6b\137\151\x64"]; goto WypBd; tEv6J: return error(-1, "\xe5\215\xa1\345\210\xb8\xe6\264\273\xe5\x8a\xa8\xe5\xb7\262\xe7\xbb\217\xe7\xbb\x93\xe6\235\237"); goto vpPH5; rYaX_: return error(-1, "\xe6\262\xa1\xe6\234\211\xe5\217\257\344\xbd\xbf\xe7\224\250\xe7\x9a\204\345\215\xa1\345\210\xb8"); goto SMmy2; dwoYX: $clerk_name = $_W["\x75\x73\x65\x72"]["\x6e\141\155\145"]; goto IGyRm; wXLYC: jf02Q: goto gtR5M; kFuZ7: goto jf02Q; goto pwMuc; GOjzI: goto r2u3x; goto W8sEy; QI8u5: if ($starttime > strtotime(date("\131\x2d\155\55\x64"))) { goto AvAer; } goto Cbiey; dfijL: WZQp1: goto bdxe2; JfAX5: if ($AWXKe) { goto P6bMh; } goto rYaX_; mO2WO: rCMPl: goto tEv6J; FtCS1: if (strtotime(str_replace("\x2e", "\x2d", $date_info["\164\151\155\x65\137\154\x69\155\151\164\137\x73\164\x61\162\164"])) > strtotime(date("\131\55\x6d\55\144"))) { goto hO706; } goto rRSUZ; RZHPF: load()->classs("\143\157\x75\160\157\x6e"); goto ops17; kj3KX: pdo_update("\x73\x74\x6f\162\145\170\x5f\143\157\165\160\157\x6e\x5f\x72\145\x63\x6f\x72\144", $update, array("\151\x64" => $coupon_record["\151\144"])); goto stkhN; WypBd: $clerk_type = $_W["\x75\163\x65\x72"]["\x74\x79\160\x65"]; goto wFb_F; o6rkE: $endtime = $starttime + $date_info["\154\x69\x6d\151\x74"] * 86400; goto QI8u5; EMy0f: return error(-1, $status["\x6d\145\x73\x73\141\147\145"]); goto mJ31K; SEjZv: } goto kOYmb; b3_av: function activity_get_user_couponlist() { goto zTN0c; zTN0c: global $_W, $_GPC; goto VCEFo; VCEFo: activity_get_coupon_type(); goto piPkZ; piPkZ: $uid = $_W["\x6d\x65\155\x62\145\162"]["\165\151\144"]; goto DaOFW; GnE1I: XwJK6: goto Db6_q; Awrts: foreach ($coupon_record as $key => $record) { goto u7NnB; IWse6: if ($aR2H7) { goto EaPjt; } goto OERQl; jypkI: TWZkM: goto LBZlD; wA88m: pdo_update("\163\164\x6f\162\x65\170\x5f\x63\157\165\160\157\x6e\x5f\x72\x65\x63\157\x72\x64", array("\163\164\141\164\x75\x73" => 2), array("\151\144" => $record["\151\144"])); goto VN9qP; K9lHr: $w89RY = !($endtime < time()); goto AyH0n; qdsZN: unset($coupon_record[$key]); goto tjGp1; qYMTi: $coupon["\145\x78\164\x72\141\137\x64\141\x74\145\x5f\x69\156\x66\157"] = "\xe6\x9c\211\xe6\225\x88\346\234\237\72" . date("\x59\x2e\155\x2e\144", $starttime) . "\x2d" . date("\x59\x2e\x6d\56\x64", $endtime); goto GkU35; GXcn_: unset($coupon_record[$key]); goto N3DeD; LkkBX: $endtime = $starttime + $coupon["\144\141\164\x65\x5f\x69\156\146\x6f"]["\154\x69\x6d\x69\x74"] * 86400; goto Izhjn; hLOKQ: $coupon_record[$key]["\162\145\x63\151\144"] = $record["\151\x64"]; goto ck3xx; XUovo: nW4Pj: goto EaYns; LbVQv: goto rk6ct; goto jypkI; LBZlD: EaPjt: goto TocLH; NobRH: goto rk6ct; goto xP2X1; ck3xx: $coupon_record[$key]["\143\x6f\144\x65"] = $record["\x63\x6f\144\x65"]; goto rDbK5; WovUt: if ($IunTw) { goto N60yz; } goto GXcn_; LqzIU: HSakI: goto X1mUp; IRCnd: if ($kwBZ8) { goto Wc5rw; } goto aYFkx; VN9qP: unset($coupon_record[$key]); goto LbVQv; X1mUp: $kwBZ8 = !($coupon["\x73\x74\x61\164\165\163"] != "\x33"); goto IRCnd; qKTTo: if ($ScRzh) { goto TLIOJ; } goto fNRZk; GkU35: goto hMXFC; goto XUovo; Y9m6M: $aY2tF = !($coupon["\163\x6f\x75\x72\x63\145"] != COUPON_TYPE); goto hwUyf; gu_xV: $aR2H7 = !(is_array($coupon["\144\141\x74\x65\137\151\x6e\x66\x6f"]) && $coupon["\x64\141\164\145\137\x69\x6e\x66\x6f"]["\164\x69\x6d\x65\137\x74\171\160\145"] == "\x31"); goto IWse6; qM1Pd: $ScRzh = !(is_array($coupon["\x64\141\x74\145\137\x69\x6e\146\x6f"]) && $coupon["\144\141\164\x65\x5f\151\156\146\157"]["\164\151\x6d\145\x5f\164\x79\160\x65"] == "\62"); goto qKTTo; tjGp1: goto rk6ct; goto LqzIU; fNRZk: $starttime = $record["\141\144\144\164\151\x6d\145"] + $coupon["\x64\141\164\x65\x5f\x69\156\146\157"]["\x64\x65\x61\144\x6c\151\156\145"] * 86400; goto LkkBX; rDbK5: rk6ct: goto pW6vN; TocLH: $coupon_record[$key] = $coupon; goto hLOKQ; xP2X1: hMXFC: goto lInPX; hwUyf: if ($aY2tF) { goto HSakI; } goto qdsZN; lInPX: TLIOJ: goto gu_xV; fCc61: $endtime = strtotime($endtime); goto K9lHr; OERQl: $endtime = str_replace("\x2e", "\55", $coupon["\144\x61\164\x65\137\151\x6e\146\157"]["\x74\151\155\145\137\154\x69\x6d\x69\164\137\145\156\144"]); goto fCc61; VwQnp: $IunTw = !is_error($coupon); goto WovUt; AcaMH: Wc5rw: goto VwQnp; EaYns: unset($coupon_record[$key]); goto MvQD4; N3DeD: goto rk6ct; goto Ou_jO; aYFkx: pdo_delete("\x73\164\157\x72\x65\170\x5f\143\157\165\x70\157\x6e\x5f\162\145\143\157\x72\144", array("\151\144" => $record["\x69\x64"])); goto xTJbJ; u7NnB: $coupon = activity_get_coupon_info($record["\143\x6f\x75\x70\x6f\156\151\x64"]); goto Y9m6M; Izhjn: if ($endtime < time()) { goto nW4Pj; } goto qYMTi; AyH0n: if ($w89RY) { goto TWZkM; } goto wA88m; Ou_jO: N60yz: goto qM1Pd; MvQD4: pdo_update("\163\164\x6f\x72\145\x78\x5f\143\157\165\x70\x6f\x6e\137\162\x65\x63\x6f\x72\x64", array("\163\164\141\164\165\x73" => 2), array("\x69\144" => $record["\x69\144"])); goto NobRH; xTJbJ: unset($coupon_record[$key]); goto dn8MR; dn8MR: goto rk6ct; goto AcaMH; pW6vN: } goto GnE1I; Db6_q: return $coupon_record; goto GNySa; DaOFW: $coupon_record = pdo_getall("\163\x74\157\162\145\x78\x5f\x63\157\165\x70\x6f\x6e\x5f\x72\145\x63\157\162\x64", array("\x75\156\x69\141\x63\x69\144" => $_W["\x75\156\x69\141\143\151\144"], "\157\x70\x65\x6e\x69\x64" => $_W["\x6f\160\145\x6e\x69\144"], "\163\164\x61\164\x75\163" => 1), array(), '', "\x61\x64\144\x74\151\155\x65\x20\104\x45\123\103"); goto Awrts; GNySa: } goto sOkI8; YW2VX: function activity_get_coupon_info($id) { goto pYQ8j; b6uJ_: $ZfHj2 = !empty($coupon); goto YdT0h; qe_L3: return error(1, "\xe5\215\241\345\x88\270\xe4\270\x8d\xe5\255\x98\xe5\234\xa8\346\210\x96\xe6\x98\257\345\267\xb2\347\xbb\217\350\xa2\253\345\210\240\xe9\x99\244"); goto QBNr0; J_j0A: $coupon = pdo_get("\x73\164\157\x72\145\x78\137\x63\x6f\x75\160\x6f\156", array("\x75\x6e\151\x61\x63\x69\x64" => $_W["\x75\x6e\x69\141\143\151\144"], "\151\144" => $id)); goto b6uJ_; i6jVy: if ($coupon["\x64\x61\164\x65\x5f\151\156\146\157"]["\164\x69\x6d\145\x5f\x74\x79\x70\145"] == "\x31") { goto M0SQ3; } goto KQFTh; Ft6i0: bXJ3T: goto Bd3WZ; qhMGz: $coupon["\154\157\x63\141\164\x69\157\x6e\137\151\144\137\154\151\x73\164"] = $stores; goto Ft6i0; b305Y: $coupon["\144\145\x73\143\x72\x69\x70\164\151\157\156"] = htmlspecialchars_decode($coupon["\x64\x65\x73\x63\162\151\x70\164\151\157\156"]); goto BqQ6I; pYQ8j: global $_W; goto f33sB; ta7u_: $cudNT = empty($coupon_stores); goto TVcq9; J2xpy: $coupon["\x64\x61\164\145\x5f\x69\156\x66\x6f"] = iunserializer($coupon["\144\141\x74\145\137\151\x6e\x66\x6f"]); goto i6jVy; KQFTh: $coupon["\145\x78\x74\162\x61\x5f\x64\141\164\145\x5f\x69\156\x66\x6f"] = "\xe6\234\211\346\225\210\xe6\234\x9f\x3a\351\242\x86\xe5\x8f\x96\345\x90\216" . ($coupon["\144\141\164\145\x5f\x69\156\x66\157"]["\x64\145\141\x64\154\151\x6e\145"] == 0 ? "\345\xbd\x93" : $coupon["\144\x61\164\145\137\x69\156\x66\157"]["\144\x65\x61\144\x6c\151\156\145"]) . "\345\244\251\345\x8f\257\347\x94\250\357\274\214\xe6\234\x89\346\225\x88\346\234\x9f" . $coupon["\x64\x61\164\x65\137\x69\x6e\x66\157"]["\154\x69\x6d\151\164"] . "\xe5\xa4\251"; goto WX4fw; BqQ6I: $coupon_stores = pdo_getall("\163\164\157\x72\145\x78\x5f\x63\157\x75\160\157\x6e\x5f\x73\164\157\x72\x65", array("\165\156\151\141\143\151\144" => $_W["\x75\156\151\141\143\x69\144"], "\x63\157\x75\x70\x6f\x6e\151\x64" => $coupon["\x69\144"]), array(), "\x73\164\157\162\x65\151\144"); goto ta7u_; JWOMq: $coupon["\145\x78\x74\162\x61"] = iunserializer($coupon["\x65\170\164\162\141"]); goto N9S51; YdT0h: if ($ZfHj2) { goto DMrx_; } goto qe_L3; Bd3WZ: return $coupon; goto xtn1f; uIsRM: $coupon["\x65\x78\x74\162\141\x5f\x64\141\x74\x65\x5f\151\x6e\146\157"] = "\xe6\234\211\346\225\x88\346\x9c\237\72" . $coupon["\x64\x61\x74\145\137\151\156\146\x6f"]["\x74\151\155\145\137\154\x69\155\151\164\137\x73\x74\x61\x72\x74"] . "\55" . $coupon["\144\x61\164\x65\x5f\x69\156\x66\157"]["\164\151\x6d\x65\x5f\x6c\x69\x6d\x69\x74\137\x65\156\144"]; goto wsUyu; QBNr0: DMrx_: goto J2xpy; N9S51: $coupon["\154\157\x67\x6f\137\165\x72\x6c"] = tomedia($coupon["\154\157\147\157\x5f\x75\162\154"]); goto b305Y; f33sB: $id = intval($id); goto J_j0A; TVcq9: if ($cudNT) { goto bXJ3T; } goto EMnFS; WX4fw: goto CB52Q; goto FYh8A; EMnFS: $stores = pdo_getall("\163\x74\157\162\145\170\137\142\x61\163\x65\163", array("\151\x64" => array_keys($coupon_stores)), array("\x74\151\164\154\145", "\x69\x64"), "\151\x64"); goto qhMGz; FYh8A: M0SQ3: goto uIsRM; wsUyu: CB52Q: goto JWOMq; xtn1f: } goto V2bii; kOYmb: function activity_get_coupon_status() { return array("\x43\101\x52\x44\x5f\x53\124\101\x54\x55\x53\137\x4e\117\124\137\x56\x45\122\111\106\131" => 1, "\x43\x41\x52\104\x5f\123\124\x41\x54\x55\x53\x5f\126\x45\x52\111\106\131\x5f\x46\x41\111\x4c" => 2, "\x43\x41\x52\x44\137\x53\x54\101\x54\x55\x53\137\126\105\x52\111\106\131\137\117\113" => 3, "\103\x41\122\x44\137\123\x54\101\x54\125\123\x5f\x55\123\105\122\x5f\104\105\114\105\x54\105" => 4, "\x43\101\x52\104\x5f\x53\124\101\x54\x55\123\x5f\x44\x45\114\105\124\105" => 4, "\x43\x41\x52\x44\137\x53\124\x41\x54\x55\123\137\x55\x53\x45\122\x5f\104\x49\123\x50\x41\x54\x43\110" => 5, "\x43\x41\x52\x44\x5f\123\124\x41\x54\x55\x53\x5f\104\x49\123\120\x41\x54\x43\110" => 5); } goto KdKak; sOkI8: function activity_paycenter_get_coupon() { goto VRkOw; hj8O5: UUvXH: goto ep4aB; XWlxj: foreach ($coupon_owned as $key => &$val) { goto yIu7L; jJ9kF: if ($Lr2kU) { goto j1hq9; } goto NC_nP; yIu7L: $KI97g = !empty($val["\x63\157\x64\145"]); goto co3UD; EWB0s: v9bcm: goto ZCPeO; rVrlA: QSh35: goto IwCeJ; ZCPeO: $Lr2kU = !($val["\164\x79\x70\x65"] == "\x31" || $val["\164\171\x70\x65"] == "\x32"); goto jJ9kF; VD9BL: unset($val); goto EWB0s; DXCXB: j1hq9: goto rVrlA; NC_nP: $coupon_available[] = $val; goto DXCXB; co3UD: if ($KI97g) { goto v9bcm; } goto VD9BL; IwCeJ: } goto hj8O5; VRkOw: $coupon_owned = activity_get_user_couponlist(); goto XWlxj; ep4aB: return $coupon_available; goto vubh7; vubh7: } goto X0XCC; E5vQt: function activity_get_member_by_type($type, $param = array()) { goto Hlqnc; Srmzu: sxYfK: goto GC4zl; oFfQ1: $members = pdo_fetchall("\123\105\114\105\x43\x54\40\141\x2e\x6f\x70\145\156\151\144\x20\x46\122\x4f\x4d\40" . tablename("\155\143\137\x6d\141\x70\160\151\156\x67\137\146\141\156\x73") . "\x20\x61\163\x20\x61\x20\x4c\105\x46\x54\x20\x4a\x4f\x49\116\x20" . tablename("\155\143\x5f\143\141\163\150\x5f\162\x65\x63\x6f\x72\x64") . "\x20\x61\x73\x20\x62\x20\117\x4e\40\141\x2e\x75\x69\144\x20\75\x20\142\x2e\x75\151\x64\x20\127\x48\x45\122\x45\x20\x61\x2e\165\x6e\151\x61\x63\x69\x64\40\x3d\x20\72\165\156\x69\141\x63\x69\x64\x20\101\x4e\104\x20\142\56\x69\144\40\x69\163\40\x6e\x75\x6c\x6c\40\xd\12\x9\x9\11\11\107\x52\x4f\x55\120\40\102\131\40\x61\56\165\151\144\x20", array("\x3a\165\x6e\x69\141\143\x69\x64" => $_W["\x75\156\x69\x61\143\151\x64"]), "\157\160\145\x6e\151\144"); goto J4W17; AZTCr: iExao: goto XHPOo; Y1UmH: $hIinm = !empty($param); goto AqbJa; Ojeeg: if ($dnqiy) { goto qNSY8; } goto pN53K; HadYk: return error("\61", "\346\xb2\xa1\xe6\234\x89\345\214\xb9\351\x85\215\xe7\x9a\204\xe7\x94\xa8\xe6\210\xb7\347\xb1\273\345\x9e\213"); goto ofhUC; rY9OD: $e5kqS = !($type == "\157\x6c\144\x5f\155\145\155\x62\x65\162"); goto uvoP4; FU9eH: $property_time = strtotime("\x2d" . $propertys["\141\x63\x74\151\166\151\x74\171\155\x65\x6d\142\145\162"] . "\x20\x6d\157\x6e\x74\150", time()); goto Pxx21; C3a1C: if ($Z3_ax) { goto FCSa_; } goto nhTGM; aL261: global $_W; goto ot8mr; AqbJa: if ($hIinm) { goto kYUEp; } goto U9wTp; YNOT6: return $members; goto H0P45; SAgEp: $members["\164\x6f\x74\x61\x6c"] = count($members["\x6d\x65\155\142\x65\162\163"]); goto ixD2l; nXw_9: $VkYdO = empty($mc_uids); goto QuHB1; mt9qB: $member = $type == "\x6f\x70\x65\x6e\x69\x64\x73" ? $members : array_keys($members); goto n7b2J; acFNg: j7LCp: goto eXD9n; uoPEF: $uids = implode("\x2c", $mc_uids); goto xE7Bc; eIzC_: $propertys = activity_storex_member_propertys(); goto LP7Ny; qeCYc: $mc_uids = array_keys($mc_cash_record); goto xCTHp; kF7va: if ($VkYdO) { goto fIjkU; } goto Qf3eJ; IT5VW: $VkYdO = empty($mc_uids); goto PezsL; n7b2J: $members = array(); goto H1cUY; ofhUC: TeOf6: goto aIh0Z; tbjho: if (COUPON_TYPE == WECHAT_COUPON) { goto sxYfK; } goto FVRdR; KkBPY: if (is_array($members)) { goto l1g1n; } goto mgK_K; Hlqnc: activity_get_coupon_type(); goto aL261; OYphN: l1g1n: goto mt9qB; CRZwQ: mFD81: goto KkBPY; Rzelw: if ($bBLKY) { goto qssZV; } goto SYeOs; YtqdY: if ($oiqE9) { goto mFD81; } goto LsaZR; SUE3A: goto G37B1; goto OYphN; ixD2l: G37B1: goto YNOT6; J4W17: $member = pdo_fetchall("\x53\105\x4c\105\103\124\x20\141\56\x6f\160\145\x6e\x69\x64\x20\106\122\x4f\x4d\x20" . tablename("\155\143\137\x6d\141\160\160\151\156\x67\x5f\146\x61\156\163") . "\40\x61\x73\40\141\40\114\x45\x46\x54\40\x4a\117\111\x4e\40" . tablename("\155\143\x5f\143\141\163\150\x5f\162\x65\143\x6f\162\144") . "\x20\x61\163\40\x62\x20\x4f\x4e\x20\141\x2e\165\x69\144\x20\x3d\40\x62\56\165\151\144\x20\x57\x48\105\x52\105\x20\141\56\165\156\x69\x61\143\x69\x64\x20\75\x20\x3a\165\x6e\151\141\x63\151\x64\40\101\x4e\104\x20\x62\56\143\162\x65\x61\x74\x65\x74\151\155\x65\40\x3e\x20\x3a\x74\x69\155\x65\x20\xd\xa\11\11\x9\x9\x47\122\117\125\x50\40\102\x59\x20\141\56\165\151\x64\x20", array("\72\165\156\151\141\143\x69\144" => $_W["\165\x6e\x69\x61\x63\151\x64"], "\x3a\164\151\155\145" => $property_time), "\x6f\160\x65\x6e\151\x64"); goto wfrHR; OUQFb: $mc_cash_record = pdo_fetchall("\123\x45\114\x45\103\124\40\x75\x69\x64\40\106\122\x4f\x4d\x20" . tablename("\155\x63\x5f\143\x61\x73\x68\x5f\162\x65\143\x6f\x72\x64") . "\40\x57\x48\105\122\x45\40\x63\162\145\141\x74\x65\164\151\155\145\x20\x3e\x3d\x20\x3a\163\x74\141\162\x74\40\x41\x4e\x44\x20\143\x72\x65\x61\x74\145\164\x69\155\145\x20\x3c\75\40\x3a\145\156\x64", array("\72\x73\164\141\162\164" => $param["\x73\164\141\x72\x74"], "\x3a\x65\x6e\144" => $param["\145\156\144"]), "\165\151\144"); goto qeCYc; uvoP4: if ($e5kqS) { goto EJqed; } goto UNpBp; XHPOo: qNSY8: goto qGvW9; SYeOs: $property_time = strtotime("\x2d" . $propertys["\156\x65\x77\x6d\x65\x6d\x62\x65\x72"] . "\x20\155\x6f\x6e\x74\x68", time()); goto qJAsQ; wk1R3: CQ_u_: goto ZrYOg; he50B: $mc_members = pdo_getall("\x6d\x63\137\155\x65\155\142\145\x72\163", array("\x75\156\151\x61\x63\151\x64" => $_W["\x75\156\x69\x61\143\151\144"], "\x63\162\x65\x61\x74\145\x74\x69\155\x65\x20\74" => $property_time), array("\165\x69\x64"), "\x75\151\144"); goto fbXUM; PJhFX: aXl3o: goto q8JH1; YEUft: if ($qIgeL) { goto TeOf6; } goto HadYk; jcdYS: $members = pdo_getall("\x6d\x63\x5f\155\x61\x70\x70\151\156\x67\x5f\x66\141\156\163", array("\165\x6e\x69\141\x63\151\144" => $_W["\x75\x6e\x69\x61\x63\x69\144"], "\x75\151\144" => $mc_uids), array("\157\160\x65\x6e\151\x64"), "\157\x70\145\x6e\151\x64"); goto wk1R3; cXdnD: $mc_cash_record = pdo_fetchall($mc_cash_record_sql, array("\72\165\151\x64\163" => $uids, "\x3a\164\151\155\145" => $property_time)); goto D89YE; aIh0Z: $members = array(); goto eIzC_; qdDcb: kcgJO: goto XmDHv; S_1Wo: $members = array(); goto nXw_9; FVRdR: $mc_members = pdo_getall("\x6d\143\x5f\155\145\155\142\x65\162\163", array("\x67\x72\157\x75\x70\x69\144" => $param["\147\162\157\x75\x70\151\x64"], "\165\x6e\151\141\x63\x69\144" => $_W["\x75\x6e\151\x61\143\x69\x64"]), array("\x75\x69\x64"), "\x75\x69\144"); goto fCEbx; wfrHR: $dnqiy = empty($member); goto Ojeeg; EWsrm: EJqed: goto Jn9lL; eXD9n: goto aXl3o; goto Srmzu; ZrYOg: L7cAp: goto e227l; D89YE: $y1A99 = empty($mc_cash_record); goto q4AFm; XmDHv: WvXZp: goto NUA7u; PmkQ1: $mc_uids = array_keys($mc_members); goto uoPEF; mX9iT: foreach ($members as $key => &$fan) { goto D5VG4; BkLo7: if ($G4sf0) { goto z3v1A; } goto mZ_HD; D5VG4: $fan["\147\x72\x6f\165\x70\151\x64"] = explode("\x2c", $fan["\x67\162\157\165\x70\x69\x64"]); goto fQNdN; mZ_HD: unset($members[$key]); goto a8n4I; yRy6A: VYblU: goto UcvhD; a8n4I: z3v1A: goto yRy6A; fQNdN: $G4sf0 = !(!is_array($fan["\147\x72\x6f\x75\x70\x69\144"]) || !in_array($param["\147\162\x6f\x75\160\151\x64"], $fan["\x67\x72\157\x75\160\x69\144"])); goto BkLo7; UcvhD: } goto byxmx; yPbKw: $Z3_ax = !($type == "\x71\x75\x69\x65\164\137\x6d\x65\x6d\142\x65\162"); goto C3a1C; ktz7O: $VkYdO = empty($mc_uids); goto kF7va; qJAsQ: $mc_members = pdo_getall("\155\x63\137\x6d\x65\155\142\x65\x72\x73", array("\165\156\151\x61\x63\151\144" => $_W["\x75\x6e\x69\141\143\x69\x64"], "\x63\x72\145\x61\164\145\164\151\155\145\40\x3e" => $property_time), array("\165\151\144"), "\165\151\x64"); goto PmkQ1; ot8mr: $types = array("\x6e\x65\167\137\155\145\x6d\x62\145\162", "\x6f\154\x64\x5f\155\145\x6d\x62\145\162", "\x71\x75\151\x65\x74\x5f\155\145\x6d\x62\145\x72", "\x61\x63\164\151\x76\151\x74\x79\137\x6d\x65\155\x62\x65\162", "\147\x72\x6f\x75\x70\x5f\x6d\x65\155\x62\x65\162", "\x63\x61\x73\x68\137\164\151\x6d\x65", "\x6f\160\x65\156\x69\144\x73"); goto XJkGj; byxmx: OXvT_: goto PJhFX; pN53K: foreach ($member as $key => $mem) { unset($members[$key]); P0o7E: } goto AZTCr; tw9UR: U5hNa: goto ktz7O; UNpBp: $property_time = strtotime("\55" . $propertys["\157\154\x64\155\x65\155\x62\x65\162"] . "\x20\x6d\x6f\156\x74\x68", time()); goto he50B; q8JH1: ecnFs: goto cm6_4; CwD3P: $members = pdo_getall("\155\143\x5f\x6d\141\x70\160\151\156\x67\x5f\146\141\156\163", array("\157\x70\x65\x6e\x69\x64\x20\x21\x3d" => '', "\165\x69\x64" => $mc_uids), array("\x6f\x70\x65\x6e\x69\144"), "\157\160\x65\156\x69\x64"); goto acFNg; H1cUY: $members["\x6d\x65\x6d\142\145\x72\163"] = $member; goto SAgEp; MH2Tf: if ($RM0Yt) { goto L7cAp; } goto OUQFb; xCTHp: $members = array(); goto IT5VW; LsaZR: $members = json_decode($_COOKIE["\x66\141\156\x73\137\157\x70\145\156\x69\x64\163" . $_W["\165\156\151\x61\143\151\x64"]]); goto CRZwQ; xE7Bc: $mc_cash_record_sql = "\123\x45\x4c\x45\x43\124\40\165\151\144\40\x46\x52\117\115\x20" . tablename("\x6d\x63\x5f\143\x61\x73\x68\137\x72\145\x63\x6f\162\x64") . "\40\x57\x48\105\122\x45\x20\165\151\x64\40\x49\x4e\40\50\x20\x3a\165\x69\144\x73\40\51\40\101\x4e\x44\x20\x63\x72\145\141\x74\x65\164\151\155\x65\x20\76\x20\72\x74\151\x6d\145\40\x47\x52\x4f\x55\120\x20\x42\x59\x20\165\x69\x64\x20\110\101\x56\x49\116\107\x20\103\117\125\x4e\124\x28\52\51\x20\x3c\40\62\40"; goto cXdnD; mgK_K: $members = array(); goto SUE3A; GC4zl: $members = pdo_getall("\155\x63\x5f\155\141\x70\x70\151\x6e\x67\137\146\x61\156\x73", array("\165\x6e\x69\141\143\x69\x64" => $_W["\x75\156\x69\141\x63\x69\144"]), array(), "\157\x70\145\156\151\x64"); goto mX9iT; cm6_4: $RM0Yt = !($type == "\143\141\163\150\x5f\164\151\155\145"); goto MH2Tf; Jn9lL: $hcCUw = !($type == "\x61\143\164\x69\166\x69\164\171\137\155\145\155\x62\x65\162"); goto dPr1x; LP7Ny: $bBLKY = !($type == "\x6e\x65\167\137\x6d\145\155\142\x65\162"); goto Rzelw; DmADU: fIjkU: goto yPbKw; dPr1x: if ($hcCUw) { goto U5hNa; } goto FU9eH; q4AFm: if ($y1A99) { goto WvXZp; } goto CPe7k; NUA7u: qssZV: goto rY9OD; CPe7k: foreach ($mc_cash_record as $v) { goto An9Xv; z9Vx7: unset($mc_uids[$v["\165\151\x64"]]); goto q6Y1s; An9Xv: $r6Mi1 = in_array($v["\165\151\144"], $mc_uids); goto Nj5UB; q6Y1s: tFtAz: goto frkjF; frkjF: A2nKV: goto rojGM; Nj5UB: if ($r6Mi1) { goto tFtAz; } goto z9Vx7; rojGM: } goto qdDcb; Pxx21: $mc_cash_record_sql = "\x53\105\x4c\105\103\x54\40\52\x20\106\122\x4f\x4d\x20" . tablename("\x6d\143\x5f\143\141\x73\x68\x5f\162\145\x63\157\162\x64") . "\x20\127\x48\x45\122\x45\40\x75\156\151\141\143\151\144\x20\x3d\40\x3a\x75\156\x69\x61\x63\x69\144\x20\x41\116\104\x20\x63\162\145\x61\164\x65\x74\151\x6d\145\x20\76\40\x3a\x74\151\x6d\145\40\x47\122\x4f\125\120\x20\102\x59\40\x75\x69\144\40\x48\101\126\111\116\107\x20\x43\x4f\125\x4e\124\x28\x2a\x29\40\x3e\x20\62"; goto mINx2; e227l: $oiqE9 = !($type == "\157\x70\x65\156\x69\x64\x73"); goto YtqdY; mINx2: $mc_cash_record = pdo_fetchall($mc_cash_record_sql, array("\72\165\156\151\x61\143\151\x64" => $_W["\x75\156\x69\141\x63\x69\144"], "\x3a\164\151\155\x65" => $property_time), "\x75\151\144"); goto fjPz1; rn14n: kYUEp: goto tbjho; yQI1P: $pomly = !($type == "\x67\162\157\165\160\x5f\155\x65\x6d\142\x65\162"); goto VGb6g; QuHB1: if ($VkYdO) { goto j7LCp; } goto CwD3P; fCEbx: $mc_uids = array_keys($mc_members); goto S_1Wo; fjPz1: $mc_uids = array_keys($mc_cash_record); goto tw9UR; Qf3eJ: $members = pdo_getall("\x6d\143\x5f\155\x61\160\160\151\x6e\x67\x5f\x66\141\x6e\163", array("\165\x69\x64" => $mc_uids, "\x6f\160\x65\x6e\x69\x64\40\x21\75" => ''), array("\157\x70\x65\156\x69\x64"), "\157\160\145\156\x69\144"); goto DmADU; nhTGM: $property_time = strtotime("\55" . $propertys["\x71\x75\x69\145\x74\x6d\145\x6d\142\x65\162"] . "\x20\155\157\156\164\x68", time()); goto oFfQ1; PezsL: if ($VkYdO) { goto CQ_u_; } goto jcdYS; fbXUM: $mc_uids = array_keys($mc_members); goto EWsrm; U9wTp: return error(1, "\350\257\267\351\200\211\346\x8b\xa9\xe4\xbc\232\345\221\230\347\xbb\x84"); goto rn14n; VGb6g: if ($pomly) { goto ecnFs; } goto Y1UmH; XJkGj: $qIgeL = in_array($type, $types); goto YEUft; qGvW9: FCSa_: goto yQI1P; H0P45: } goto HXeF8; HXeF8: function activity_storex_member_propertys() { goto wOEeB; HSV1v: return $propertys; goto IpW2C; McogP: SO9Pe: goto Z6DPm; Z6DPm: $propertys = json_decode($current_property_info["\x70\x72\x6f\x70\x65\162\164\x79"], true); goto JrEnF; PyCVr: $current_property_info = pdo_get("\163\164\157\162\145\170\x5f\x6d\x63\137\x6d\145\155\142\145\162\137\x70\x72\x6f\160\x65\x72\164\171", array("\165\x6e\151\141\143\151\144" => $_W["\x75\156\x69\x61\x63\151\144"])); goto vbmgK; vbmgK: if (!empty($current_property_info)) { goto SO9Pe; } goto xmB2K; JrEnF: Ek4B1: goto HSV1v; yuNsY: goto Ek4B1; goto McogP; wOEeB: global $_W; goto PyCVr; xmB2K: $propertys = array("\x6e\x65\x77\155\x65\x6d\x62\145\162" => "\61", "\x6f\154\x64\x6d\x65\x6d\142\145\x72" => "\62", "\x61\x63\164\151\x76\x69\x74\171\155\145\x6d\x62\x65\162" => "\x31", "\x71\165\x69\x65\164\155\145\x6d\142\x65\162" => "\x31"); goto yuNsY; IpW2C: } goto KSpRt; ZtRvV: function activity_get_coupon_type() { goto nhuJF; RFOj0: goto xEQAX; goto MRzZy; MRzZy: tONRm: goto hlHmY; moxXo: define("\103\117\x55\120\117\x4e\137\124\131\120\x45", WECHAT_COUPON); goto RFOj0; Ao7JW: $setting = pdo_get("\x73\x74\x6f\x72\x65\x78\137\x73\x65\164", array("\167\145\x69\144" => $_W["\x75\x6e\151\141\143\x69\x64"]), "\163\x6f\165\x72\x63\145"); goto QsmoR; QsmoR: if ($setting["\x73\x6f\165\x72\143\x65"] == 1) { goto tONRm; } goto moxXo; nhuJF: global $_W; goto Ao7JW; JxLUV: xEQAX: goto rNaKv; hlHmY: define("\103\117\125\120\117\x4e\137\x54\x59\120\105", SYSTEM_COUPON); goto JxLUV; rNaKv: } goto pFyVX; Anf5e: function activity_get_exchange_info($exchangeid, $uniacid = 0) { goto b_B_B; gOiY9: $o70n_ = !(!empty($exchange) && !empty($exchange["\x65\170\x74\162\141"])); goto fIhOo; UxZDq: $exchange = pdo_get("\163\164\157\x72\145\170\x5f\x61\x63\164\151\166\x69\x74\171\x5f\145\x78\143\x68\x61\156\x67\145", array("\x69\144" => $exchangeid, "\x75\x6e\151\x61\143\151\x64" => $uniacid)); goto gOiY9; aUpWO: return $exchange; goto DCxNJ; b_B_B: global $_W; goto eT9xB; fIhOo: if ($o70n_) { goto tKB0v; } goto Zp6xq; eT9xB: $uniacid = intval($uniacid) ? intval($uniacid) : $_W["\165\156\151\x61\143\x69\x64"]; goto UxZDq; Zp6xq: $exchange["\x65\170\164\162\x61"] = iunserializer($exchange["\x65\x78\164\162\141"]); goto TUG3L; TUG3L: tKB0v: goto aUpWO; DCxNJ: } goto fkvcn; V2bii: function activity_user_get_coupon($id, $openid, $granttype = 1) { goto RrIGA; lbVvW: $credit_names = array("\x63\162\145\144\x69\x74\x31" => "\347\xa7\xaf\xe5\210\x86", "\x63\162\145\x64\x69\x74\62" => "\344\xbd\x99\xe9\xa2\235"); goto QjvJY; TeJPv: return error(-1, "\346\xb4\xbb\xe5\212\250\346\x9c\252\345\274\x80\xe5\247\x8b"); goto l0Oas; Jzqdd: goto VOZUQ; goto yCKCW; OWlpP: $insert["\143\x61\162\x64\137\151\144"] = $coupon["\x63\141\162\144\137\151\x64"]; goto RZ0Y2; wg8OB: zqcvp: goto FSS1N; W6IOp: goto YOM_6; goto nUkg8; o3saz: $give = $_W["\x61\x63\164\151\166\151\164\x79\x5f\143\157\165\x70\157\x6e\x5f\x69\x64"] ? true : false; goto DuMaa; Qcv_l: return $insert_id; goto Dfmq9; hHGH_: YCGb2: goto luRjI; jqe17: YOM_6: goto xCAfG; fgMgI: if ($aHPRj) { goto NuM1I; } goto UnMM2; wGKwX: if ($pcount >= $coupon["\x67\145\x74\137\154\x69\x6d\x69\x74"] && !empty($coupon["\x67\x65\164\137\x6c\x69\x6d\151\164"])) { goto CZ3km; } goto zryrh; lw020: JHL3n: goto AmRpY; coJaX: goto YOM_6; goto wg8OB; Bp3tb: if ($coupon["\x71\x75\141\156\164\x69\x74\x79"] <= 0) { goto JHL3n; } goto wGKwX; ZkysU: if ($granttype == 2) { goto zqcvp; } goto uezeb; h0kh3: $insert["\143\x61\x72\x64\137\x69\x64"] = $coupon["\x63\141\162\144\x5f\x69\x64"]; goto krYVS; KwpEv: $pcount = pdo_fetchcolumn("\x53\105\114\105\103\124\40\x63\x6f\x75\x6e\x74\50\52\x29\x20\106\122\117\x4d\40" . tablename("\x73\164\157\x72\145\170\x5f\143\157\x75\x70\x6f\x6e\137\x72\x65\143\157\x72\x64") . "\x20\127\x48\105\x52\105\40\x60\x6f\160\x65\x6e\151\144\140\40\75\40\x3a\x6f\160\145\156\x69\144\x20\101\116\x44\x20\x60\143\x6f\x75\x70\x6f\x6e\x69\x64\x60\40\75\40\x3a\x63\157\165\x70\157\x6e\151\x64", array("\x3a\143\157\x75\x70\x6f\x6e\x69\x64" => $id, "\x3a\157\x70\145\x6e\151\x64" => $openid)); goto d2mrB; h09uu: $code = base_convert(md5(uniqid() . random(4)), 16, 10); goto KkAUi; FGm4_: $openid = $fan["\157\160\145\156\151\x64"]; goto SxRtG; m0lO5: goto YOM_6; goto u7XZ1; nDrYn: return error(-1, "\345\x85\x91\346\215\xa2\345\244\xb1\xe8\264\245"); goto Lu_gE; PCdW6: $insert["\x72\x65\155\141\162\153"] = $give ? "\xe7\263\273\xe7\273\x9f\xe8\xb5\xa0\xe9\200\x81" : "\xe7\224\250\xe6\x88\267\xe4\xbd\277\347\x94\xa8" . $exchange["\143\162\x65\144\151\x74"] . $credit_names[$exchange["\143\162\x65\x64\151\x74\164\171\x70\x65"]] . "\xe5\x85\221\xe6\215\242"; goto coJaX; eHC_f: CZ3km: goto iCKUr; TOhlN: $aHPRj = !empty($openid); goto zNMhH; IkW8J: if ($CyFD7) { goto K5TCc; } goto OWlpP; FSS1N: $insert["\x72\x65\155\x61\162\x6b"] = "\xe6\211\xab\347\xa0\x81\xe8\x8e\267\xe5\217\x96"; goto m0lO5; igyeV: vBLR2: goto Qcv_l; RZ0Y2: K5TCc: goto yhbqr; d354r: goto VOZUQ; goto eHC_f; nUkg8: h9Q09: goto eQ0WU; yCKCW: VJtci: goto TeJPv; zryrh: goto VOZUQ; goto FWGvi; RcLwC: if (strtotime(str_replace("\x2e", "\x2d", $coupon["\144\x61\164\145\137\x69\x6e\146\157"]["\x74\x69\x6d\x65\x5f\154\151\x6d\x69\x74\x5f\x73\164\x61\x72\x74"])) > strtotime(date("\x59\x2d\155\55\144")) && $coupon["\144\141\x74\145\x5f\151\156\146\157"]["\x74\x69\155\145\137\x74\171\x70\x65"] != 2) { goto VJtci; } goto Bp3tb; uezeb: if ($granttype == 3) { goto hhMh5; } goto W6IOp; UnMM2: return error(-1, "\346\xb2\241\xe6\234\x89\xe6\211\xbe\345\x88\xb0\346\214\x87\345\xae\232\344\xbc\x9a\xe5\221\230"); goto ZQTXQ; KkAUi: $code = substr($code, 1, 16); goto muOKp; uFcEK: if ($aHPRj) { goto VNxlO; } goto M86e0; xcKAo: $openid = $_W["\155\x65\155\x62\145\x72"]["\165\x69\x64"]; goto KjFW3; Di0gC: $fan = mc_fansinfo($openid, '', $_W["\165\x6e\151\x61\x63\x69\144"]); goto FGm4_; l0Oas: goto VOZUQ; goto lw020; luRjI: return error(-1, "\xe6\xb4\273\xe5\212\250\xe5\267\xb2\xe7\xbb\x93\346\235\x9f"); goto Jzqdd; ZQTXQ: NuM1I: goto lCRw_; HY5ds: pdo_update("\163\x74\157\162\x65\x78\x5f\x63\x6f\x75\x70\157\x6e", array("\x71\165\141\156\164\151\164\x79" => $coupon["\161\165\x61\x6e\164\151\x74\x79"] - 1, "\144\x6f\x73\x61\x67\145" => $coupon["\144\157\x73\x61\x67\145"] + 1), array("\165\156\151\141\143\151\144" => $_W["\165\156\x69\141\x63\151\x64"], "\x69\144" => $coupon["\151\x64"])); goto GdXV0; I3T93: $aHPRj = !empty($openid); goto fgMgI; Lu_gE: k1GzB: goto h09uu; krYVS: $insert["\x63\x6f\x64\145"] = ''; goto YipBw; GdXV0: $lgc1t = !($granttype == 1); goto VnUhM; muOKp: $user = mc_fetch($fan["\165\151\144"], array("\x67\162\157\x75\160\x69\x64")); goto lbVvW; rfqwr: $insert = array("\143\x6f\x75\x70\157\156\151\144" => $id, "\165\151\144" => $uid, "\165\x6e\151\x61\x63\151\144" => $_W["\x75\156\151\141\143\x69\x64"], "\x6f\160\x65\x6e\151\x64" => $fan["\157\x70\145\156\x69\144"], "\x63\x6f\x64\145" => $code, "\x67\x72\x61\x6e\164\155\x6f\x64\x75\154\145" => $give ? $_W["\141\143\x74\x69\x76\151\164\171\137\x63\x6f\x75\160\x6f\x6e\137\151\x64"] : $_W["\x63\165\x72\x72\x65\156\x74\x5f\155\157\144\x75\x6c\x65"]["\x6e\x61\155\145"], "\141\x64\144\x74\x69\155\145" => TIMESTAMP, "\163\x74\x61\x74\165\163" => 1, "\x67\162\x61\156\164\x74\x79\160\x65" => $granttype); goto mdk0E; VnUhM: if ($lgc1t) { goto vBLR2; } goto sb4vm; FWGvi: xyN_2: goto FdV01; FdV01: return error(-1, "\346\x9c\252\xe6\211\xbe\345\210\xb0\346\214\x87\xe5\xae\232\xe5\215\241\xe5\x88\xb8"); goto N7Gm1; d2mrB: if (empty($coupon)) { goto xyN_2; } goto zNDFK; jYCwM: VOZUQ: goto o3saz; iCKUr: return error(-1, "\351\xa2\206\345\217\226\xe6\xac\241\346\x95\260\xe4\270\x8d\xe8\xb6\xb3\x21"); goto jYCwM; L3fUZ: $insert["\162\145\x6d\141\162\153"] = "\xe7\263\273\347\273\237\346\264\xbe\xe5\217\x91"; goto jqe17; cakE8: $aHPRj = !empty($openid); goto uFcEK; N7Gm1: goto VOZUQ; goto hHGH_; mdk0E: if ($granttype == 1) { goto h9Q09; } goto ZkysU; zNDFK: if (strtotime(str_replace("\x2e", "\55", $coupon["\144\141\x74\x65\137\x69\156\146\157"]["\x74\x69\x6d\145\x5f\154\151\x6d\151\x74\137\145\x6e\x64"])) < strtotime(date("\x59\x2d\x6d\x2d\144")) && $coupon["\144\x61\x74\145\x5f\151\156\146\157"]["\164\151\x6d\x65\137\x74\171\160\145"] != 2) { goto YCGb2; } goto RcLwC; RrIGA: global $_W, $_GPC; goto cakE8; lCRw_: VNxlO: goto Di0gC; AmRpY: return error(-1, "\345\215\xa1\xe5\x88\xb8\xe5\217\221\346\224\xbe\345\256\x8c\346\xaf\x95"); goto d354r; i9n0y: if ($aHPRj) { goto k1GzB; } goto nDrYn; eQ0WU: $exchange = pdo_get("\163\x74\x6f\162\x65\170\137\x61\x63\164\x69\166\x69\164\x79\x5f\x65\x78\143\x68\x61\x6e\x67\x65", array("\165\156\x69\x61\x63\151\x64" => $_W["\165\x6e\x69\141\143\151\x64"], "\145\170\164\x72\141" => $id), array()); goto PCdW6; s3KB5: $CyFD7 = !empty($insert["\x63\141\162\x64\x5f\x69\144"]); goto IkW8J; sb4vm: pdo_update("\163\164\157\162\145\170\x5f\141\143\x74\x69\x76\x69\164\171\137\x65\x78\143\150\141\x6e\147\145", array("\x6e\x75\x6d" => $exchange["\x6e\165\x6d"] + 1), array("\x69\144" => $exchange["\x69\x64"])); goto igyeV; KjFW3: wr8Mw: goto I3T93; QjvJY: $coupon = activity_get_coupon_info($id); goto KwpEv; M86e0: $openid = $_W["\x6f\160\145\156\x69\144"]; goto TOhlN; u7XZ1: hhMh5: goto L3fUZ; DuMaa: $uid = !empty($_W["\x6d\x65\x6d\x62\x65\162"]["\x75\151\x64"]) ? $_W["\155\145\155\x62\x65\162"]["\165\151\x64"] : $fan["\165\151\x64"]; goto rfqwr; rXXQe: if ($y95Vr) { goto Joi2X; } goto h0kh3; yhbqr: pdo_insert("\163\x74\157\x72\x65\170\137\143\157\165\160\157\156\x5f\x72\145\143\157\162\x64", $insert); goto eBHHE; zNMhH: if ($aHPRj) { goto wr8Mw; } goto xcKAo; eBHHE: $insert_id = pdo_insertid(); goto HY5ds; SxRtG: $aHPRj = !empty($openid); goto i9n0y; xCAfG: $y95Vr = !($coupon["\x73\x6f\x75\162\x63\145"] == 2); goto rXXQe; YipBw: Joi2X: goto s3KB5; Dfmq9: } goto b3_av; pFyVX: function activity_get_coupon_label($type = '') { $types = array(COUPON_TYPE_DISCOUNT => array("\164\x69\164\x6c\x65" => "\346\x8a\230\346\x89\xa3\345\x88\270", "\166\141\x6c\x75\x65" => "\x64\151\163\x63\157\x75\x6e\164"), COUPON_TYPE_CASH => array("\x74\151\164\x6c\x65" => "\xe4\xbb\243\351\x87\221\xe5\210\270", "\x76\x61\x6c\x75\x65" => "\143\x61\163\150"), COUPON_TYPE_GIFT => array("\x74\x69\x74\154\x65" => "\347\xa4\xbc\345\x93\x81\xe5\210\xb8", "\x76\x61\154\165\x65" => "\x67\151\x66\x74"), COUPON_TYPE_GROUPON => array("\164\151\x74\x6c\x65" => "\345\233\xa2\350\264\255\xe5\210\270", "\x76\x61\x6c\x75\145" => "\147\x72\x6f\165\160\x6f\156"), COUPON_TYPE_GENERAL => array("\x74\x69\164\154\x65" => "\344\274\230\346\x83\xa0\xe5\210\xb8", "\x76\x61\154\x75\145" => "\147\x65\156\145\162\x61\154\x5f\x63\x6f\165\160\157\156")); return $types[$type] ? $types[$type] : $types; } goto LvaHN; LvaHN: function activity_get_coupon_colors() { $colors = array("\103\157\154\157\x72\60\61\60" => "\43\x35\65\142\144\64\x37", "\x43\x6f\x6c\157\162\60\62\60" => "\x23\61\60\x61\144\66\61", "\x43\x6f\154\157\162\x30\63\x30" => "\x23\63\x35\x61\x34\x64\145", "\x43\x6f\x6c\x6f\162\x30\x34\x30" => "\43\x33\x64\x37\70\x64\x61", "\x43\157\x6c\157\x72\x30\x35\x30" => "\43\71\60\65\x38\143\142", "\x43\157\154\x6f\162\x30\x36\60" => "\x23\x64\145\71\143\x33\x33", "\103\x6f\154\x6f\162\60\x37\60" => "\x23\x65\x62\141\x63\x31\66", "\x43\x6f\154\157\x72\x30\70\60" => "\x23\x66\x39\x38\x36\61\x66", "\x43\157\154\x6f\x72\x30\x38\61" => "\x23\x66\60\70\65\60\60", "\x43\x6f\x6c\x6f\x72\60\70\x32" => "\43\141\71\144\x39\62\144", "\103\157\x6c\157\162\60\x39\60" => "\43\x65\x37\65\67\63\x35", "\x43\x6f\x6c\157\162\61\60\60" => "\x23\x64\65\x34\x30\x33\66", "\103\x6f\154\157\x72\x31\60\61" => "\x23\143\146\63\x65\x33\x36", "\x43\157\x6c\157\162\x31\60\62" => "\43\65\145\x36\66\x37\x31"); return $colors; } goto YW2VX; CsG5D: function storex_account_change_operator($clerk_type, $store_id, $clerk_id) { goto XSKKh; dsEcF: goto aDPm1; goto hXEi_; khbuw: $clerks = pdo_getall("\163\164\157\x72\x65\x78\x5f\x61\143\164\x69\166\151\x74\x79\x5f\x63\x6c\x65\162\153\x73", array("\x75\x6e\x69\x61\143\x69\x64" => $_W["\165\156\x69\x61\x63\x69\x64"]), array("\x69\x64", "\x6e\141\x6d\145"), "\151\x64"); goto p1_1w; LhioW: $TlDNe = !empty($data["\143\x6c\145\x72\153\x5f\143\156"]); goto v8VNd; O_e6Q: SH8Ck: goto PrsM_; nKNWQ: if ($v9QKz) { goto aqKUf; } goto bS1mA; hXEi_: wrXBI: goto D__s8; D__s8: if (empty($clerk_id)) { goto SH8Ck; } goto bImj4; R1JuC: goto aDPm1; goto UyXKX; p1_1w: $stores = pdo_getall("\163\x74\x6f\x72\145\170\x5f\141\143\x74\151\x76\x69\164\x79\x5f\163\164\x6f\162\145\163", array("\165\156\x69\x61\143\x69\144" => $_W["\165\156\151\141\143\x69\x64"]), array("\x69\x64", "\142\165\x73\x69\x6e\145\163\x73\137\156\141\155\x65", "\x62\162\141\x6e\143\x68\x5f\156\x61\x6d\x65"), "\151\144"); goto zLuTt; bImj4: $data["\x63\x6c\x65\162\x6b\x5f\x63\x6e"] = $clerks[$clerk_id]["\x6e\141\155\x65"]; goto lsAmj; NeoaN: $m3tRq = !(empty($stores) || empty($clerks)); goto QwyJy; D7FcC: $data["\143\x6c\145\x72\x6b\x5f\x63\x6e"] = "\347\263\xbb\xe7\273\x9f"; goto f8alr; XWnnk: if ($clerk_type == 3) { goto wrXBI; } goto R1JuC; YH_Bn: return $data; goto gwd6t; f8alr: goto aDPm1; goto seMds; i_k4W: $v9QKz = !empty($data["\163\x74\x6f\x72\145\137\x63\156"]); goto nKNWQ; Ir2aC: if ($clerk_type == 1) { goto O0Vj4; } goto r23Pf; ZltRn: $data["\x63\x6c\x65\162\x6b\137\143\x6e"] = "\346\x9a\202\xe6\x97\240\346\223\x8d\344\275\x9c\345\x91\230\344\277\xa1\346\201\xaf"; goto rdazS; v8VNd: if ($TlDNe) { goto nw0Ci; } goto ZltRn; hkU08: dT1oJ: goto BLF6X; PrsM_: $data["\x63\x6c\x65\x72\153\137\143\x6e"] = "\xe6\234\254\344\272\272\xe6\x93\215\xe4\275\x9c"; goto hkU08; kSgKn: aqKUf: goto LhioW; PwkXk: aDPm1: goto i_k4W; lsAmj: goto dT1oJ; goto O_e6Q; XSKKh: global $stores, $clerks, $_W; goto NeoaN; QwyJy: if ($m3tRq) { goto wbbng; } goto khbuw; B5DZ7: $data["\x63\154\x65\162\153\137\143\156"] = pdo_fetchcolumn("\x53\105\x4c\x45\103\x54\x20\x75\163\x65\162\x6e\x61\155\145\x20\106\122\117\115\x20" . tablename("\x75\163\145\162\163") . "\40\x57\x48\105\122\105\x20\x75\151\144\40\x3d\40\x3a\165\x69\x64", array("\72\165\x69\x64" => $clerk_id)); goto dsEcF; UyXKX: O0Vj4: goto D7FcC; xUgb_: $data = array("\x63\154\145\x72\x6b\137\x63\x6e" => '', "\x73\164\157\162\145\137\x63\156" => ''); goto Ir2aC; rdazS: nw0Ci: goto YH_Bn; seMds: cItJA: goto B5DZ7; zLuTt: wbbng: goto xUgb_; BLF6X: $data["\x73\x74\157\162\145\x5f\143\156"] = $stores[$store_id]["\142\165\x73\151\x6e\145\x73\163\137\156\x61\x6d\x65"] . "\40" . $stores[$store_id]["\142\162\141\156\x63\150\x5f\156\x61\x6d\145"]; goto PwkXk; bS1mA: $data["\x73\164\x6f\162\145\x5f\x63\x6e"] = "\xe6\232\x82\xe6\227\240\xe9\x97\xa8\345\272\x97\344\xbf\241\346\x81\xaf"; goto kSgKn; r23Pf: if ($clerk_type == 2) { goto cItJA; } goto XWnnk; gwd6t: } goto Anf5e; KSpRt: function activity_storex_sync() { goto rGGlD; LOJC0: cache_write($cachekey, array("\145\x78\x70\151\x72\145" => time() + 1800)); goto UTMJ3; UTMJ3: return true; goto cmVOR; u9aeL: return false; goto cN_er; GJm7p: $KiiU3 = !(!empty($cache) && $cache["\x65\170\160\x69\x72\x65"] > time()); goto D8t6q; hGvMn: load()->classs("\143\157\x75\160\157\156"); goto Pob2a; gW1jU: foreach ($stores as $val) { goto NVkve; kgsPF: $location = $location["\x62\165\163\x69\x6e\x65\x73\163"]["\x62\x61\x73\x65\x5f\x69\156\146\157"]; goto Eq2hH; NVkve: $sP6T2 = !($val["\x73\164\x61\164\165\163"] == 3); goto MmPuo; sI3ws: $category_temp = explode("\x2c", $location["\x63\x61\x74\145\x67\157\162\x69\145\163"][0]); goto ISP71; Gjy3y: goto MHbuh; goto fELTH; MmPuo: if ($sP6T2) { goto KvTJX; } goto Gjy3y; I_t2U: MHbuh: goto pGGWZ; ucIa6: return error(-1, $location["\155\145\x73\163\141\147\x65"]); goto MHh9o; kB3xX: $SRCPN = !is_error($location); goto KRnFT; CALnJ: $location["\x6c\157\143\x61\164\x69\x6f\156\137\x69\144"] = $location["\160\157\x69\x5f\x69\144"]; goto sI3ws; emIcC: $location = $acc->LocationGet($val["\x6c\x6f\143\x61\164\151\157\x6e\137\151\144"]); goto kB3xX; fELTH: KvTJX: goto GtQsu; KRnFT: if ($SRCPN) { goto cgHvI; } goto ucIa6; MHh9o: cgHvI: goto kgsPF; lbVot: $location["\163\x74\x61\164\165\163"] = $status2local[$location["\x61\166\141\x69\154\x61\x62\154\x65\137\163\x74\x61\164\x65"]]; goto CALnJ; GylR8: pdo_update("\x73\164\157\162\145\x78\137\x61\143\x74\151\166\151\x74\171\x5f\x73\164\157\162\145\x73", $location, array("\165\x6e\151\141\143\x69\x64" => $_W["\x75\156\x69\x61\x63\x69\x64"], "\151\x64" => $val["\151\144"])); goto I_t2U; nsst3: $location["\160\x68\x6f\x74\x6f\x5f\x6c\x69\x73\x74"] = iserializer($location["\x70\x68\157\164\157\x5f\x6c\x69\163\164"]); goto kLqcx; GtQsu: $acc = new coupon($_W["\141\x63\x69\x64"]); goto emIcC; ISP71: $location["\143\x61\x74\x65\x67\x6f\162\x79"] = iserializer(array("\x63\141\164\145" => $category_temp[0], "\x73\165\x62" => $category_temp[1], "\x63\154\141\x73" => $category_temp[2])); goto nsst3; kLqcx: unset($location["\x63\141\x74\145\x67\x6f\x72\x69\x65\x73"], $location["\x70\x6f\151\x5f\151\144"], $location["\165\x70\144\141\164\145\x5f\163\164\141\164\x75\x73"], $location["\x61\x76\x61\151\154\141\142\154\145\x5f\x73\x74\141\x74\x65"], $location["\157\146\146\163\x65\x74\137\164\x79\160\145"], $location["\163\151\x64"], $location["\164\171\160\145"], $location["\161\165\x61\154\x69\x66\151\x63\141\x74\151\x6f\156\137\x6c\x69\163\164"], $location["\165\x70\x67\162\141\144\x65\x5f\x63\157\155\155\x65\x6e\x74"], $location["\165\160\x67\162\x61\x64\145\137\x73\164\141\x74\165\x73"], $location["\155\141\160\151\x64"]); goto GylR8; Eq2hH: $status2local = array('', 3, 2, 1, 3); goto lbVot; pGGWZ: } goto ygTqS; D8t6q: if ($KiiU3) { goto oU0Z5; } goto u9aeL; D3vz1: $stores = pdo_getall("\x73\x74\157\x72\x65\x78\x5f\x61\x63\x74\x69\x76\x69\164\x79\137\163\x74\x6f\x72\145\x73", array("\x75\x6e\x69\x61\143\x69\144" => $_W["\165\156\x69\141\143\x69\x64"], "\x73\157\165\162\143\x65" => 2)); goto gW1jU; ygTqS: i_eOS: goto LOJC0; cN_er: oU0Z5: goto D3vz1; y4x3l: $cache = cache_load($cachekey); goto GJm7p; Pob2a: $cachekey = "\x73\x74\157\162\145\x78\163\171\156\143\72{$_W["\165\x6e\151\x61\143\151\x64"]}"; goto y4x3l; rGGlD: global $_W; goto hGvMn; cmVOR: } goto CsG5D; KdKak: function activity_wechat_coupon_sync() { goto uKU8J; zCi5c: foreach ($cards as $val) { goto CcJ1Q; eS3gY: $status = $coupon_status[$card[$type]["\142\141\163\x65\x5f\151\156\x66\157"]["\x73\x74\x61\164\x75\x73"]]; goto wtFxc; ny0bn: $wzp2g = !is_error($card); goto uS3cQ; FHMjk: return error(-1, $card["\x6d\x65\163\x73\141\147\x65"]); goto oMqsP; A4QTj: $type = strtolower($card["\143\141\x72\x64\137\164\x79\x70\145"]); goto mxTO6; mxTO6: $coupon_status = activity_get_coupon_status(); goto eS3gY; oMqsP: XSAFF: goto A4QTj; rqT2r: MHpwE: goto Iiayh; wtFxc: $status = pdo_update("\163\x74\x6f\162\145\x78\x5f\x63\157\x75\160\x6f\x6e", array("\x73\164\141\164\165\163" => $status), array("\151\x64" => $val["\x69\x64"])); goto rqT2r; CcJ1Q: $card = $coupon_api->fetchCard($val["\143\141\162\144\x5f\151\x64"]); goto ny0bn; uS3cQ: if ($wzp2g) { goto XSAFF; } goto FHMjk; Iiayh: } goto xKmZ1; mAuOB: return false; goto F9dJn; vGq6U: activity_get_coupon_type(); goto A0rNO; uKU8J: global $_W; goto Ldcin; F9dJn: AAAIT: goto YH5VL; lhYnk: return true; goto dhM_C; cg5LQ: $cache = cache_load($cachekey); goto sxTvT; A0rNO: $cards = pdo_getall("\x73\x74\x6f\x72\145\170\x5f\x63\157\165\160\x6f\x6e", array("\x75\156\151\x61\x63\151\144" => $_W["\x75\156\x69\141\143\x69\x64"], "\163\x6f\165\162\x63\145" => COUPON_TYPE), array("\151\x64", "\163\164\141\x74\x75\163", "\x63\141\162\x64\137\x69\x64", "\141\143\x69\144")); goto zCi5c; sxTvT: $KiiU3 = !(!empty($cache) && $cache["\145\170\x70\x69\x72\145"] > time()); goto WtcLW; xKmZ1: Q_d_s: goto vlwlF; ky19U: $coupon_api = new coupon(); goto vGq6U; WtcLW: if ($KiiU3) { goto AAAIT; } goto mAuOB; Ldcin: $cachekey = "\x77\x6e\137\163\x74\157\162\x65\170\137\143\x6f\x75\160\x6f\x6e\163\x79\156\143\x3a{$_W["\165\156\151\141\x63\151\144"]}"; goto cg5LQ; vlwlF: cache_write($cachekey, array("\145\x78\160\x69\162\x65" => time() + 1800)); goto lhYnk; YH5VL: load()->classs("\x63\x6f\x75\x70\157\156"); goto ky19U; dhM_C: } goto E5vQt; fkvcn: function activity_user_get_goods($uid, $exid) { goto Vy_Zc; wUkC_: if ($fEKy0) { goto vodEw; } goto kQd20; M7mHi: pdo_insert("\163\164\x6f\x72\x65\x78\137\x61\x63\164\151\166\x69\164\x79\137\x65\170\x63\150\141\156\147\x65\137\164\x72\141\144\145\x73", $data); goto oKlDZ; VJC9Z: return $insert_id; goto E8k3f; ywRyK: lfRDI: goto R_OAu; YHuBa: $exid = intval($exid); goto LOgCo; VKzYf: YVMPq: goto auKMR; Vy_Zc: global $_W; goto YHuBa; L01F5: $pnum = pdo_fetchcolumn("\x53\x45\114\x45\103\x54\x20\103\117\125\x4e\124\x28\52\x29\x20\106\x52\x4f\x4d\x20" . tablename("\x73\164\x6f\x72\145\170\137\x61\x63\164\x69\166\x69\x74\171\x5f\145\170\143\x68\x61\x6e\147\x65\137\164\162\141\144\x65\x73") . "\x20\127\x48\x45\122\105\x20\165\x6e\151\141\143\151\x64\40\x3d\40\x3a\x75\156\x69\141\x63\x69\144\x20\101\x4e\104\40\x75\x69\144\40\x3d\40\72\x75\x69\144\40\x41\x4e\104\x20\x65\170\x69\144\40\75\x20\x3a\145\x78\151\144", array("\72\165\x6e\151\141\143\151\144" => $_W["\165\x6e\x69\x61\143\151\x64"], "\72\x75\151\x64" => $uid, "\72\145\170\x69\x64" => $exid)); goto On6ZR; fabIy: $VAjQj = !($exchange["\163\x74\x61\162\x74\x74\x69\x6d\x65"] > TIMESTAMP); goto SbNTp; gjY2i: return error(-1, "\350\257\xa5\xe5\256\236\347\x89\xa9\xe5\205\221\xe6\x8d\242\xe6\xaf\217\344\272\272\345\217\252\xe8\x83\275\xe4\xbd\xbf\347\x94\250" . $exchange["\x70\162\145\164\157\164\141\154"] . "\xe6\xac\xa1"); goto G7iyz; oKlDZ: $insert_id = pdo_insertid(); goto E3Il5; Ga00W: Jb3CQ: goto L01F5; sFXXZ: vodEw: goto fabIy; mkKoH: if ($wa43t) { goto Efc9S; } goto gjY2i; kQd20: return error(-1, "\346\xb2\241\346\x9c\211\346\x8c\207\345\256\232\xe7\232\204\xe5\xae\x9e\347\211\xa9\xe5\x85\x91\xe6\x8d\xa2"); goto sFXXZ; b2M27: if ($W01bM) { goto Jb3CQ; } goto Sa028; E3Il5: $McyXz = !empty($insert_id); goto cw9Zc; DLdJE: IsnHk: goto lRpwN; Kjibl: $exchange = activity_get_exchange_info($exid, $_W["\165\156\151\141\143\151\144"]); goto YQWlJ; LOgCo: $uid = intval($uid); goto Kjibl; YQWlJ: $fEKy0 = !empty($exchange); goto wUkC_; Ugovm: pdo_insert("\163\164\x6f\x72\145\170\137\x61\143\x74\151\x76\x69\x74\171\x5f\x65\170\x63\150\141\x6e\x67\x65\137\164\162\141\x64\145\x73\x5f\163\150\x69\x70\x70\x69\x6e\x67", $insert); goto t5vN2; SRppR: return error(-1, "\xe5\xae\x9e\347\211\251\xe5\x85\221\346\x8d\xa2\345\xa4\261\xe8\264\xa5"); goto VKzYf; SbNTp: if ($VAjQj) { goto lfRDI; } goto ttXfR; Sa028: return error(-1, "\350\xaf\xa5\345\256\x9e\347\x89\251\xe5\205\221\346\215\xa2\xe5\267\262\xe7\xbb\x8f\347\xbb\x93\xe6\235\237"); goto Ga00W; ttXfR: return error(-1, "\350\xaf\245\xe5\xae\236\347\211\xa9\xe5\x85\221\346\x8d\242\345\260\x9a\xe6\x9c\252\345\274\x80\xe5\xa7\213"); goto ywRyK; t5vN2: pdo_update("\x73\164\157\162\145\170\137\x61\143\x74\151\166\151\164\171\137\x65\x78\x63\150\141\156\147\x65", array("\156\165\155" => $exchange["\x6e\x75\x6d"] + 1), array("\151\x64" => $exid, "\165\x6e\x69\x61\x63\151\144" => $_W["\x75\x6e\x69\141\x63\151\x64"])); goto VJC9Z; M0bCT: if ($Yo4ED) { goto IsnHk; } goto T3bSe; T3bSe: return error(-1, "\xe8\xaf\xa5\xe5\xae\x9e\xe7\211\251\345\205\x91\xe6\x8d\242\xe5\xb7\xb2\345\205\x91\xe6\215\242\345\256\x8c"); goto DLdJE; R_OAu: $W01bM = !($exchange["\145\156\144\x74\151\x6d\145"] < TIMESTAMP); goto b2M27; cw9Zc: if ($McyXz) { goto YVMPq; } goto SRppR; SibSM: $Yo4ED = !($exchange["\x6e\165\x6d"] >= $exchange["\x74\x6f\x74\141\x6c"]); goto M0bCT; G7iyz: Efc9S: goto SibSM; On6ZR: $wa43t = !($pnum >= $exchange["\x70\x72\x65\x74\157\164\141\154"]); goto mkKoH; lRpwN: $data = array("\165\x6e\151\x61\143\151\144" => $_W["\165\156\151\141\x63\151\144"], "\x75\x69\144" => $uid, "\164\171\160\145" => 3, "\145\170\x69\144" => $exid, "\x63\x72\x65\x61\164\145\164\x69\155\x65" => TIMESTAMP); goto M7mHi; auKMR: $insert = array("\164\x69\144" => $insert_id, "\165\156\151\x61\143\x69\144" => $_W["\x75\156\x69\x61\143\x69\144"], "\x75\151\x64" => $uid, "\163\x74\x61\x74\x75\x73" => 0, "\145\170\x69\x64" => $exid, "\143\x72\x65\x61\164\145\x74\x69\x6d\145" => TIMESTAMP); goto Ugovm; E8k3f: }