<?php
 goto nXvsx; nXvsx: defined("\111\116\x5f\x49\101") or die("\x41\x63\143\145\163\x73\x20\x44\x65\156\x69\x65\144"); goto Rey3P; Rey3P: load()->classs("\143\157\x75\x70\157\156"); goto uoFqh; uoFqh: class WnCoupon extends coupon { public function BuildCardExt($id, $openid = '') { goto mrltE; YAU6C: if ($d5ChV) { goto JduGe; } goto AwGVl; bVLMs: $cardExt = json_encode($cardExt); goto EeIJY; EeIJY: return array("\x63\141\162\x64\137\151\144" => $card_id, "\143\x61\162\x64\x5f\145\170\x74" => $cardExt); goto YNcGH; nQ1g3: if ($EdGqS) { goto xLQlR; } goto t8JAQ; t8JAQ: return error(-1, "\xe5\215\241\345\x88\270\151\144\344\xb8\x8d\xe5\220\210\346\263\225"); goto xDtwi; kRHXP: $EdGqS = !empty($card_id); goto nQ1g3; G9Fj5: $d5ChV = !is_error($signature); goto YAU6C; xDtwi: xLQlR: goto kXKl0; mrltE: $card_id = pdo_fetchcolumn("\x53\x45\114\x45\x43\x54\x20\143\x61\x72\x64\137\151\x64\40\x46\x52\x4f\x4d\40" . tablename("\x73\x74\x6f\162\145\x78\137\x63\157\165\160\157\156") . "\40\127\110\x45\122\x45\x20\x69\144\x20\75\40\72\151\144", array("\x3a\151\x64" => $id)); goto kRHXP; kXKl0: $time = TIMESTAMP; goto BBsZZ; AwGVl: return $signature; goto BP2f3; IZ9wi: $cardExt = array("\164\x69\x6d\x65\163\x74\141\x6d\x70" => $time, "\163\x69\x67\156\x61\164\165\162\145" => $signature); goto bVLMs; BP2f3: JduGe: goto IZ9wi; BBsZZ: $sign = array($card_id, $time); goto XzHMu; XzHMu: $signature = $this->SignatureCard($sign); goto G9Fj5; YNcGH: } }