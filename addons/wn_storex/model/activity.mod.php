<?php
 goto cG8nY; P_OYY: function activity_get_user_couponlist() { goto J4X5D; a_cw9: $uid = $_W["\155\145\155\x62\145\x72"]["\x75\151\144"]; goto rSxDt; B31iV: KwcWM: goto C4qZG; J4X5D: global $_W, $_GPC; goto dyxWU; C4qZG: return $coupon_record; goto ji30d; dyxWU: activity_get_coupon_type(); goto a_cw9; rSxDt: $coupon_record = pdo_getall("\x73\164\157\162\145\170\137\x63\x6f\165\160\x6f\x6e\x5f\162\x65\143\x6f\162\x64", array("\x75\x6e\x69\x61\x63\151\x64" => $_W["\165\x6e\x69\141\143\151\x64"], "\x6f\160\145\156\x69\144" => $_W["\x6f\x70\x65\156\151\144"], "\163\x74\141\164\x75\x73" => 1), array(), '', "\x61\x64\144\x74\x69\155\145\x20\x44\105\x53\x43"); goto UAIZa; UAIZa: foreach ($coupon_record as $key => $record) { goto bu9OY; nihBb: if ($yzov4) { goto cOuEV; } goto K7xlK; MU_2H: cOuEV: goto sL1Lj; QBUEH: if ($ZqZpq) { goto kFLup; } goto K7kpq; jbtCa: unset($coupon_record[$key]); goto lpv9J; OeuOB: mY7i5: goto roM_X; bu9OY: $coupon = activity_get_coupon_info($record["\143\157\x75\160\x6f\x6e\151\x64"]); goto CbFsA; cWfTB: unset($coupon_record[$key]); goto RS5HB; sL1Lj: $mSG1i = !(is_array($coupon["\x64\x61\x74\145\137\151\156\146\x6f"]) && $coupon["\x64\x61\x74\x65\137\x69\156\146\157"]["\164\151\155\x65\137\x74\x79\160\145"] == "\62"); goto wl_TS; aCnn8: $coupon_record[$key]["\x72\145\143\151\x64"] = $record["\151\144"]; goto iNZZi; K7kpq: $endtime = str_replace("\56", "\x2d", $coupon["\144\x61\x74\x65\137\x69\x6e\146\157"]["\164\151\155\145\137\x6c\x69\155\151\x74\x5f\145\156\144"]); goto xtChB; a46fJ: vv9sr: goto DidPy; cgTrK: $qh1A7 = !($coupon["\163\164\141\x74\165\163"] != "\63"); goto jRHhG; N5nuM: $yzov4 = !is_error($coupon); goto nihBb; FBIQz: pdo_update("\x73\164\157\x72\x65\170\137\x63\157\x75\x70\157\156\137\x72\x65\x63\x6f\x72\x64", array("\x73\164\x61\x74\165\163" => 2), array("\x69\x64" => $record["\x69\x64"])); goto zkZZ5; Lf7C1: goto B_sMn; goto mi10O; mi10O: QwXU1: goto OeuOB; jRHhG: if ($qh1A7) { goto QTk1w; } goto Nurc8; zkZZ5: unset($coupon_record[$key]); goto uZ6cx; lpv9J: pdo_update("\163\164\x6f\x72\145\170\137\x63\157\165\x70\157\x6e\x5f\162\145\x63\157\x72\x64", array("\x73\164\141\x74\x75\163" => 2), array("\x69\x64" => $record["\x69\144"])); goto Lf7C1; Nurc8: pdo_delete("\163\164\x6f\x72\145\170\137\143\157\x75\x70\x6f\156\x5f\162\x65\143\157\162\x64", array("\151\144" => $record["\151\144"])); goto cWfTB; DidPy: kFLup: goto tt946; mCXQD: $endtime = $starttime + $coupon["\x64\x61\x74\x65\137\x69\156\146\157"]["\154\151\x6d\151\x74"] * 86400; goto O3G1N; NUlpG: goto B_sMn; goto VVHX3; ll6Rz: goto QwXU1; goto zgHC7; O3G1N: if ($endtime < time()) { goto MXzya; } goto NMLBC; RS5HB: goto B_sMn; goto CSrLv; CSrLv: QTk1w: goto N5nuM; dYtDs: if ($U3V1V) { goto jLpSX; } goto FTUpc; roM_X: $ZqZpq = !(is_array($coupon["\x64\141\164\x65\x5f\151\156\x66\x6f"]) && $coupon["\144\x61\x74\x65\x5f\x69\x6e\146\x6f"]["\164\x69\155\x65\x5f\164\x79\160\145"] == "\x31"); goto QBUEH; NMLBC: $coupon["\x65\170\x74\162\x61\137\144\141\x74\x65\x5f\x69\x6e\x66\157"] = "\xe6\x9c\211\xe6\x95\210\xe6\234\x9f\x3a" . date("\x59\x2e\x6d\x2e\x64", $starttime) . "\55" . date("\x59\56\155\56\x64", $endtime); goto ll6Rz; ruEHr: $starttime = $record["\x61\x64\x64\x74\151\x6d\145"] + $coupon["\144\141\x74\x65\137\151\156\146\x6f"]["\x64\145\141\144\x6c\151\x6e\x65"] * 86400; goto mCXQD; tt946: $coupon_record[$key] = $coupon; goto aCnn8; E2Do2: $DBrBq = !($endtime < time()); goto t8U5S; uZ6cx: goto B_sMn; goto a46fJ; FTUpc: unset($coupon_record[$key]); goto NUlpG; zgHC7: MXzya: goto jbtCa; VVHX3: jLpSX: goto cgTrK; CbFsA: $U3V1V = !($coupon["\x73\x6f\165\162\143\145"] != COUPON_TYPE); goto dYtDs; t8U5S: if ($DBrBq) { goto vv9sr; } goto FBIQz; K7xlK: unset($coupon_record[$key]); goto bvk8C; cNKmH: B_sMn: goto laYtM; xtChB: $endtime = strtotime($endtime); goto E2Do2; bvk8C: goto B_sMn; goto MU_2H; wl_TS: if ($mSG1i) { goto mY7i5; } goto ruEHr; iNZZi: $coupon_record[$key]["\143\157\x64\145"] = $record["\143\157\144\x65"]; goto cNKmH; laYtM: } goto B31iV; ji30d: } goto NCIuh; Ee4v5: function activity_get_coupon_colors() { $colors = array("\103\157\154\157\x72\x30\61\x30" => "\43\x35\x35\142\144\x34\x37", "\103\157\154\157\x72\60\x32\x30" => "\x23\61\60\x61\x64\66\61", "\103\157\154\x6f\x72\60\63\x30" => "\x23\x33\65\x61\x34\x64\145", "\x43\x6f\x6c\x6f\x72\60\x34\x30" => "\x23\x33\144\67\70\x64\141", "\103\x6f\x6c\157\x72\x30\x35\x30" => "\43\71\x30\x35\x38\x63\x62", "\103\157\154\157\x72\x30\66\x30" => "\x23\144\145\x39\x63\63\63", "\x43\x6f\154\157\162\x30\67\x30" => "\x23\145\142\141\x63\61\x36", "\x43\157\x6c\157\x72\x30\70\60" => "\43\146\x39\x38\x36\61\x66", "\103\157\x6c\x6f\162\x30\70\x31" => "\x23\x66\60\70\65\x30\60", "\103\157\154\x6f\x72\60\70\x32" => "\x23\x61\x39\144\x39\62\144", "\x43\x6f\x6c\x6f\162\60\x39\x30" => "\43\145\67\65\67\63\x35", "\103\157\154\157\162\61\x30\x30" => "\x23\144\65\64\x30\63\x36", "\103\157\x6c\x6f\162\x31\60\x31" => "\x23\x63\x66\63\x65\63\66", "\x43\157\x6c\157\162\x31\x30\x32" => "\43\x35\145\x36\66\67\x31"); return $colors; } goto iDvhs; Y_OiS: function activity_get_exchange_info($exchangeid, $uniacid = 0) { goto JtYWy; QSogd: $exchange["\145\170\x74\162\x61"] = iunserializer($exchange["\x65\170\x74\x72\x61"]); goto b1zCt; YLmOP: $dT2JT = !(!empty($exchange) && !empty($exchange["\x65\170\x74\162\x61"])); goto pGqBu; pGqBu: if ($dT2JT) { goto FeItr; } goto QSogd; RLrm3: $uniacid = intval($uniacid) ? intval($uniacid) : $_W["\x75\x6e\x69\x61\x63\151\x64"]; goto PvV0v; PvV0v: $exchange = pdo_get("\x73\164\x6f\x72\145\170\137\x61\143\164\151\166\x69\x74\171\x5f\145\170\x63\150\141\x6e\x67\145", array("\x69\x64" => $exchangeid, "\165\156\151\141\x63\151\144" => $uniacid)); goto YLmOP; JtYWy: global $_W; goto RLrm3; b1zCt: FeItr: goto pE3Nr; pE3Nr: return $exchange; goto PQA5k; PQA5k: } goto zgnOe; ZVc3f: function activity_coupon_consume($couponid, $recid, $store_id) { goto W2OXV; jYAI1: ioe82: goto FnJz3; FAo11: pdo_update("\x73\x74\157\x72\145\170\137\143\x6f\165\x70\x6f\x6e\x5f\x72\x65\143\x6f\x72\144", $update, array("\x69\144" => $coupon_record["\x69\144"])); goto oDuoV; mrQHk: $I_MNA = !empty($coupon_record); goto S9epb; SwutH: if ($endtime < strtotime(date("\131\x2d\155\x2d\144"))) { goto gTpn5; } goto z3oA7; oDuoV: return true; goto rEO00; mBzdN: if (strtotime(str_replace("\x2e", "\x2d", $date_info["\x74\x69\x6d\x65\137\154\151\155\x69\164\x5f\145\x6e\144"])) < strtotime(date("\x59\55\155\x2d\x64"))) { goto tkkR1; } goto ilnO1; Cu2Ra: goto Q3CGL; goto LN9la; Li9pW: if ($starttime > strtotime(date("\x59\x2d\155\x2d\144"))) { goto tchTT; } goto SwutH; LN9la: V1Oc4: goto RP8Ig; QGWvJ: if ($v90y8) { goto fECq4; } goto tnpOX; lGDe8: return error(-1, "\xe5\215\xa1\345\x88\xb8\xe6\264\xbb\345\x8a\xa8\345\267\262\xe7\273\217\xe7\xbb\x93\346\235\237"); goto SbVJO; MewCQ: return error(-1, "\xe6\262\xa1\xe6\x9c\x89\xe6\214\207\xe5\xae\x9a\347\x9a\x84\xe5\215\xa1\xe5\210\xb8\344\277\xa1\xe6\201\257"); goto H0Tyc; W2OXV: global $_W, $_GPC; goto ZY3Lx; ETizH: return error(-1, "\346\262\xa1\xe6\234\x89\xe5\217\257\344\275\277\347\x94\250\xe7\232\x84\xe5\x8d\241\xe5\x88\xb8"); goto nc0db; vKRCT: k7L7w: goto GFmdt; qQIev: $status = $coupon_api->ConsumeCode(array("\x63\157\144\x65" => $coupon_record["\143\x6f\144\x65"])); goto z80ZU; aNHdD: if ($date_info["\164\151\155\x65\x5f\164\171\x70\145"] == "\x31") { goto V1Oc4; } goto bwMyp; Cpi2z: SOiiu: goto vKRCT; LTM3I: noMvR: goto NpRf8; GFmdt: $update = array("\x73\164\x61\164\165\x73" => 2, "\x75\163\145\x74\151\155\145" => TIMESTAMP, "\x63\x6c\145\162\x6b\137\156\x61\155\x65" => $clerk_name, "\x63\154\x65\x72\153\x5f\x69\144" => intval($clerk_id), "\x63\154\x65\x72\x6b\x5f\164\x79\x70\145" => $clerk_type, "\163\164\157\x72\145\137\151\x64" => $store_id); goto FAo11; vuuHG: return error(-1, "\345\215\241\345\210\270\xe6\xb4\xbb\345\x8a\250\xe5\267\xb2\xe7\273\217\347\273\223\xe6\x9d\237"); goto jYAI1; DQAlq: $coupon_api = new coupon($_W["\141\x63\x69\144"]); goto qQIev; tIhPP: return error(-1, "\xe8\257\245\xe9\227\250\xe5\xba\227\xe6\x97\xa0\346\xb3\225\xe4\275\277\xe7\x94\250"); goto LTM3I; SbVJO: V2vb2: goto Cu2Ra; mutHV: if ($DJzB9) { goto k7L7w; } goto aRmWb; GRiW3: $v90y8 = empty($location_id_list); goto QGWvJ; k6iqA: tchTT: goto J5u6Z; XCb2K: $endtime = $starttime + $date_info["\x6c\x69\x6d\x69\164"] * 86400; goto Li9pW; nc0db: i5pSW: goto YHCSs; okqRm: $coupon_record = pdo_get("\163\x74\x6f\x72\x65\x78\x5f\143\x6f\x75\160\157\156\x5f\x72\x65\x63\157\162\144", array("\151\x64" => $recid, "\163\164\x61\164\x75\163" => "\61")); goto mrQHk; RP8Ig: if (strtotime(str_replace("\x2e", "\x2d", $date_info["\164\151\155\x65\x5f\x6c\x69\x6d\151\164\x5f\x73\x74\x61\162\x74"])) > strtotime(date("\131\x2d\155\55\x64"))) { goto D_ebY; } goto mBzdN; tGeXk: D_ebY: goto fgOto; J3IL2: return error(-1, $status["\155\145\x73\x73\141\147\x65"]); goto Cpi2z; S9epb: if ($I_MNA) { goto i5pSW; } goto ETizH; prc2Y: tkkR1: goto vuuHG; pIhBb: $DJzB9 = !($coupon_info["\163\x6f\165\162\143\145"] == "\x32"); goto mutHV; ZY3Lx: $clerk_name = $_W["\x75\x73\145\x72"]["\156\141\155\x65"]; goto QJ3IX; Xozjf: $date_info = iunserializer($coupon_info["\144\141\164\145\137\151\156\146\x6f"]); goto aNHdD; H0Tyc: KfYYz: goto mms8X; YHCSs: $coupon_info = activity_get_coupon_info($couponid); goto qvZZg; NC_h6: goto ioe82; goto prc2Y; hqkt5: $clerk_type = $_W["\165\163\145\x72"]["\x74\171\x70\145"]; goto okqRm; ApoCM: gTpn5: goto lGDe8; bwMyp: $starttime = strtotime(date("\131\x2d\155\x2d\x64", $coupon_record["\141\x64\144\x74\x69\155\145"])) + $date_info["\144\x65\141\144\154\x69\156\x65"] * 86400; goto XCb2K; z80ZU: $IO62I = !is_error($status); goto OhmMN; TNcWc: goto V2vb2; goto ApoCM; ilnO1: goto ioe82; goto tGeXk; FnJz3: Q3CGL: goto pIhBb; QJ3IX: $clerk_id = $_W["\x75\163\145\x72"]["\x63\x6c\145\x72\x6b\x5f\x69\144"]; goto hqkt5; OhmMN: if ($IO62I) { goto SOiiu; } goto J3IL2; mms8X: $uid = $coupon_record["\165\151\x64"]; goto w2erX; NpRf8: fECq4: goto Xozjf; fgOto: return error(-1, "\xe5\215\xa1\xe5\x88\270\xe6\264\273\xe5\x8a\xa8\345\xb0\232\346\x9c\252\345\xbc\x80\xe5\247\213"); goto NC_h6; w2erX: $location_id_list = $coupon_info["\154\x6f\x63\x61\x74\x69\x6f\156\137\151\144\x5f\x6c\151\x73\164"]; goto GRiW3; J5u6Z: return error(-1, "\xe5\215\241\345\x88\xb8\346\264\273\345\x8a\250\xe5\xb0\232\346\x9c\252\xe5\xbc\200\345\xa7\213"); goto TNcWc; qvZZg: $nIBE2 = !empty($coupon_info); goto hlNtE; tnpOX: $JtQAw = in_array($store_id, array_keys($location_id_list)); goto XuQIM; XuQIM: if ($JtQAw) { goto noMvR; } goto tIhPP; z3oA7: goto V2vb2; goto k6iqA; hlNtE: if ($nIBE2) { goto KfYYz; } goto MewCQ; aRmWb: load()->classs("\x63\157\x75\160\x6f\x6e"); goto DQAlq; rEO00: } goto y6v_y; y6v_y: function activity_get_coupon_status() { return array("\x43\101\122\x44\137\x53\124\101\124\125\x53\137\x4e\x4f\x54\x5f\x56\x45\x52\x49\106\131" => 1, "\x43\101\x52\104\137\x53\x54\x41\x54\x55\123\137\x56\x45\x52\111\106\131\137\106\101\111\x4c" => 2, "\103\101\x52\104\137\x53\124\x41\x54\125\x53\137\126\x45\x52\111\x46\x59\x5f\x4f\113" => 3, "\103\x41\x52\x44\137\x53\124\x41\124\x55\123\137\125\x53\x45\122\137\104\x45\114\x45\124\x45" => 4, "\x43\x41\x52\104\x5f\123\x54\x41\x54\x55\x53\x5f\104\105\114\x45\x54\105" => 4, "\103\101\122\x44\x5f\123\124\x41\124\125\123\137\125\x53\x45\122\137\x44\x49\123\120\101\124\x43\x48" => 5, "\103\101\x52\x44\137\123\x54\x41\x54\125\123\137\104\111\x53\120\x41\x54\103\x48" => 5); } goto wi0UY; Ugtsg: function activity_storex_member_propertys() { goto GUj6x; sT31V: KGeXw: goto vdML4; vdML4: $propertys = json_decode($current_property_info["\x70\x72\157\160\x65\x72\164\x79"], true); goto fEIdK; GUj6x: global $_W; goto W5eDk; NVJ85: $propertys = array("\156\x65\x77\x6d\145\155\142\145\162" => "\61", "\x6f\x6c\x64\155\145\155\142\x65\162" => "\62", "\x61\143\x74\x69\x76\151\x74\x79\155\x65\155\x62\x65\x72" => "\x31", "\x71\x75\x69\x65\x74\x6d\x65\x6d\142\145\162" => "\x31"); goto bUsgx; W5eDk: $current_property_info = pdo_get("\163\x74\157\x72\x65\x78\x5f\x6d\x63\137\x6d\145\x6d\x62\x65\x72\x5f\x70\x72\x6f\x70\145\x72\x74\171", array("\165\x6e\151\141\x63\x69\x64" => $_W["\165\x6e\151\141\x63\x69\144"])); goto gDVAK; fEIdK: GNvs4: goto Z0Inx; bUsgx: goto GNvs4; goto sT31V; Z0Inx: return $propertys; goto FJEQA; gDVAK: if (!empty($current_property_info)) { goto KGeXw; } goto NVJ85; FJEQA: } goto Rm6g4; NCIuh: function activity_paycenter_get_coupon() { goto gkvX0; XUYFK: Vre8J: goto BLMKL; BLMKL: return $coupon_available; goto oRWPD; kk7_Y: foreach ($coupon_owned as $key => &$val) { goto HfFBq; alnkO: rqitO: goto xYCnv; xYCnv: m3G9w: goto IUonZ; uSflR: $uuiZh = !($val["\164\x79\x70\145"] == "\61" || $val["\x74\171\160\x65"] == "\62"); goto n3GuG; Nxp8n: yqQLv: goto uSflR; iZrP2: unset($val); goto Nxp8n; HfFBq: $KhER8 = !empty($val["\x63\x6f\x64\x65"]); goto F0lsA; n3GuG: if ($uuiZh) { goto rqitO; } goto S5rlY; S5rlY: $coupon_available[] = $val; goto alnkO; F0lsA: if ($KhER8) { goto yqQLv; } goto iZrP2; IUonZ: } goto XUYFK; gkvX0: $coupon_owned = activity_get_user_couponlist(); goto kk7_Y; oRWPD: } goto ZVc3f; V8LTS: function activity_get_coupon_label($type = '') { $types = array(COUPON_TYPE_DISCOUNT => array("\x74\151\164\x6c\145" => "\346\212\230\xe6\x89\243\345\x88\270", "\x76\x61\154\165\x65" => "\x64\x69\x73\x63\x6f\x75\x6e\164"), COUPON_TYPE_CASH => array("\x74\x69\164\154\x65" => "\xe4\273\xa3\xe9\x87\x91\xe5\x88\270", "\166\x61\x6c\165\x65" => "\x63\141\x73\x68"), COUPON_TYPE_GIFT => array("\164\x69\x74\x6c\145" => "\347\244\274\xe5\x93\x81\345\x88\xb8", "\166\141\x6c\x75\x65" => "\147\x69\x66\164"), COUPON_TYPE_GROUPON => array("\x74\x69\164\x6c\145" => "\345\x9b\xa2\350\xb4\xad\xe5\210\xb8", "\x76\141\154\x75\x65" => "\x67\x72\157\x75\x70\157\156"), COUPON_TYPE_GENERAL => array("\164\151\x74\154\x65" => "\xe4\274\x98\xe6\x83\240\xe5\210\270", "\x76\x61\154\x75\x65" => "\147\x65\x6e\145\162\x61\x6c\137\143\x6f\165\x70\x6f\x6e")); return $types[$type] ? $types[$type] : $types; } goto Ee4v5; wi0UY: function activity_wechat_coupon_sync() { goto H0lt2; gCsMc: if ($gA1Kt) { goto miRWH; } goto tJ2wY; L515i: cache_write($cachekey, array("\x65\x78\x70\151\x72\145" => time() + 1800)); goto HXj4F; k1xOT: $cards = pdo_getall("\163\164\157\x72\x65\x78\x5f\x63\x6f\x75\160\x6f\156", array("\165\x6e\x69\x61\143\x69\144" => $_W["\165\x6e\x69\x61\143\151\x64"], "\163\x6f\165\x72\143\x65" => COUPON_TYPE), array("\151\x64", "\163\164\x61\x74\165\163", "\x63\x61\162\144\137\x69\144", "\141\143\151\144")); goto Zs2L0; NwuCn: $cache = cache_load($cachekey); goto Lf9m1; TNtRJ: $cachekey = "\167\156\137\x73\x74\157\162\145\170\137\x63\157\165\160\x6f\x6e\x73\x79\x6e\143\x3a{$_W["\165\x6e\151\x61\143\151\x64"]}"; goto NwuCn; HXj4F: return true; goto yDB6x; H0lt2: global $_W; goto TNtRJ; tJ2wY: return false; goto XCsV2; uXjP1: load()->classs("\143\x6f\x75\160\157\x6e"); goto Xorwi; Xorwi: $coupon_api = new coupon(); goto sIVtS; v3idL: ts54s: goto L515i; sIVtS: activity_get_coupon_type(); goto k1xOT; Zs2L0: foreach ($cards as $val) { goto t8ktO; z9TSH: CX4gl: goto fGER_; fGER_: $type = strtolower($card["\x63\141\162\144\x5f\164\x79\x70\145"]); goto QXNt8; t8ktO: $card = $coupon_api->fetchCard($val["\143\141\162\144\137\151\144"]); goto u3MKf; vpuj9: $status = pdo_update("\x73\x74\x6f\162\145\170\137\x63\157\165\x70\x6f\x6e", array("\x73\164\141\x74\x75\x73" => $status), array("\151\x64" => $val["\151\x64"])); goto rwra_; vrn6T: $status = $coupon_status[$card[$type]["\142\141\x73\145\x5f\151\x6e\x66\x6f"]["\x73\x74\x61\x74\x75\x73"]]; goto vpuj9; u3MKf: $DORqH = !is_error($card); goto m2l0K; t7GGr: return error(-1, $card["\x6d\x65\163\163\141\147\145"]); goto z9TSH; QXNt8: $coupon_status = activity_get_coupon_status(); goto vrn6T; m2l0K: if ($DORqH) { goto CX4gl; } goto t7GGr; rwra_: g29ZH: goto E5IaW; E5IaW: } goto v3idL; XCsV2: miRWH: goto uXjP1; Lf9m1: $gA1Kt = !(!empty($cache) && $cache["\145\170\x70\151\162\x65"] > time()); goto gCsMc; yDB6x: } goto zmjDi; zmjDi: function activity_get_member_by_type($type, $param = array()) { goto CAEW1; Td5hN: global $_W; goto gWyOl; Y7aem: $members = pdo_fetchall("\123\x45\114\x45\x43\124\x20\x61\56\157\x70\145\x6e\151\x64\x20\x46\x52\117\115\x20" . tablename("\155\x63\137\x6d\141\x70\x70\151\x6e\x67\x5f\146\141\x6e\163") . "\40\141\163\40\x61\x20\114\105\106\124\x20\x4a\117\111\116\x20" . tablename("\x6d\143\x5f\143\141\163\150\137\162\x65\143\x6f\x72\144") . "\x20\141\x73\x20\x62\40\x4f\x4e\40\x61\56\165\x69\x64\x20\75\x20\x62\x2e\165\x69\144\40\x57\x48\105\122\x45\x20\141\56\x75\x6e\151\x61\x63\151\x64\x20\75\x20\x3a\165\x6e\151\x61\143\151\144\40\x41\116\x44\40\x62\56\151\x64\x20\151\163\40\156\x75\154\x6c\x20\15\xa\x9\x9\11\11\x47\122\117\125\x50\40\102\x59\x20\141\56\x75\x69\144\40", array("\x3a\x75\x6e\x69\141\x63\151\144" => $_W["\x75\x6e\x69\x61\143\x69\x64"]), "\x6f\160\x65\x6e\x69\x64"); goto WbsM0; kzotq: $mc_cash_record = pdo_fetchall("\x53\x45\x4c\x45\103\x54\40\x75\151\144\x20\106\x52\x4f\115\x20" . tablename("\155\143\x5f\x63\141\163\x68\137\x72\145\x63\157\162\x64") . "\x20\127\x48\x45\122\105\x20\x63\162\145\141\164\145\x74\x69\155\145\x20\x3e\x3d\x20\72\x73\164\x61\x72\x74\40\x41\x4e\104\40\x63\162\145\x61\164\x65\164\x69\x6d\145\40\74\x3d\x20\72\145\156\144", array("\72\x73\x74\x61\162\164" => $param["\x73\164\x61\x72\x74"], "\x3a\145\156\144" => $param["\145\x6e\x64"]), "\165\151\144"); goto syBI5; lcGsA: if ($DfY62) { goto WaJ1q; } goto xCGE0; DNZEx: $GkWFY = empty($mc_uids); goto Rm9Df; KKImA: $members = array(); goto mVqZx; umi68: $members = array(); goto DNZEx; uRwEe: foreach ($members as $key => &$fan) { goto KAu4T; TVnKs: C5c11: goto GEvVC; GEvVC: fEOls: goto R8XWk; KAu4T: $fan["\147\162\x6f\x75\x70\151\144"] = explode("\54", $fan["\147\x72\157\x75\x70\x69\144"]); goto elkeY; SEiIs: if ($U1RFX) { goto C5c11; } goto XamJd; XamJd: unset($members[$key]); goto TVnKs; elkeY: $U1RFX = !(!is_array($fan["\147\162\157\x75\x70\151\x64"]) || !in_array($param["\x67\162\x6f\165\160\151\144"], $fan["\147\x72\157\x75\x70\151\x64"])); goto SEiIs; R8XWk: } goto t0Y0P; RgP8O: $members = array(); goto BPApi; jPodi: $mc_uids = array_keys($mc_members); goto s_0X7; CAEW1: activity_get_coupon_type(); goto Td5hN; ov533: $property_time = strtotime("\55" . $propertys["\x71\165\x69\x65\164\x6d\x65\x6d\x62\145\162"] . "\x20\155\157\156\164\150", time()); goto Y7aem; xSuR9: XnfXD: goto hIYdT; mVqZx: $propertys = activity_storex_member_propertys(); goto xeHnr; bKYDJ: if ($g7BPR) { goto WCpCm; } goto LWCf3; lJbb7: RZ7F7: goto kVQ4X; Uv7AZ: $GkWFY = empty($mc_uids); goto gqQzK; fx0Vy: if ($Tuznc) { goto svVXn; } goto UWpxy; t0Y0P: oyy5w: goto sNyUu; BlE4C: return error(1, "\xe8\257\267\xe9\x80\211\346\x8b\251\xe4\274\232\345\x91\230\xe7\xbb\204"); goto Duhxp; ij0IU: hb7aU: goto FWZIu; xCGE0: $property_time = strtotime("\x2d" . $propertys["\156\145\x77\155\x65\155\142\x65\162"] . "\40\155\157\x6e\164\150", time()); goto O1pIY; o8_rW: zuPf6: goto o6SUa; of63U: foreach ($member as $key => $mem) { unset($members[$key]); UJIgv: } goto BX9ky; OGxzi: $members = pdo_getall("\x6d\143\137\x6d\141\160\160\x69\156\147\x5f\x66\x61\156\163", array("\x75\x6e\x69\141\143\x69\x64" => $_W["\x75\x6e\151\141\x63\x69\x64"], "\165\151\x64" => $mc_uids), array("\157\x70\x65\x6e\x69\x64"), "\x6f\160\145\156\151\x64"); goto AAwT9; P3HrK: $zEJEE = in_array($type, $types); goto ztBo3; AAwT9: Y39Xt: goto ssNvc; c5R1n: return error("\61", "\346\xb2\241\346\x9c\211\345\214\271\351\x85\215\xe7\x9a\x84\xe7\x94\250\xe6\210\267\xe7\xb1\273\xe5\x9e\x8b"); goto qQZ8_; nnmAu: WaJ1q: goto ex4S0; WbsM0: $member = pdo_fetchall("\x53\105\114\105\103\x54\x20\141\56\157\x70\x65\x6e\x69\x64\40\106\122\x4f\x4d\40" . tablename("\x6d\x63\137\155\141\160\160\x69\x6e\x67\x5f\x66\x61\x6e\x73") . "\x20\141\x73\40\x61\40\x4c\x45\106\x54\x20\x4a\x4f\111\116\40" . tablename("\155\143\137\143\x61\163\x68\137\162\145\x63\157\x72\x64") . "\x20\x61\x73\x20\x62\x20\x4f\x4e\40\141\56\x75\x69\x64\40\75\x20\x62\x2e\x75\x69\x64\x20\x57\110\x45\122\105\x20\141\x2e\x75\x6e\151\141\x63\x69\144\x20\75\x20\x3a\x75\x6e\x69\x61\x63\x69\144\40\101\116\104\x20\142\56\143\x72\x65\141\164\145\164\x69\155\x65\x20\76\40\72\164\151\x6d\145\40\xd\12\11\11\x9\11\107\122\x4f\x55\x50\40\102\131\40\141\x2e\x75\151\144\x20", array("\72\165\156\151\x61\x63\151\x64" => $_W["\165\156\x69\x61\x63\x69\x64"], "\x3a\164\151\155\x65" => $property_time), "\157\x70\145\156\x69\x64"); goto I49Lq; AEoSb: $members = array(); goto Uv7AZ; ex4S0: $Tuznc = !($type == "\x6f\154\x64\x5f\x6d\x65\155\142\x65\162"); goto fx0Vy; ZQN4P: if ($UtIf2) { goto An7AD; } goto ov533; GcKt3: $members["\x6d\145\x6d\142\x65\x72\163"] = $member; goto NAIUI; ZYJMx: $mc_cash_record_sql = "\x53\x45\x4c\105\103\124\x20\x2a\40\x46\122\x4f\x4d\40" . tablename("\x6d\143\x5f\143\141\x73\150\137\x72\x65\x63\157\162\144") . "\40\x57\x48\105\122\105\x20\165\156\151\x61\143\151\144\x20\x3d\40\72\x75\x6e\x69\x61\x63\151\x64\x20\x41\x4e\104\x20\143\x72\145\141\x74\x65\164\151\155\145\x20\76\x20\x3a\164\x69\x6d\x65\40\107\x52\x4f\125\120\x20\102\131\40\x75\x69\x64\x20\x48\x41\126\111\x4e\107\x20\103\x4f\125\x4e\124\x28\52\51\x20\76\x20\62"; goto EvUWs; txyxQ: if ($zS_4y) { goto RZ7F7; } goto of63U; m7bRR: WCpCm: goto YLQon; tsMa9: wXUBD: goto WNTu5; AKIdh: $members = array(); goto GcKt3; ebk9l: if (COUPON_TYPE == WECHAT_COUPON) { goto bExDN; } goto Ps840; EvUWs: $mc_cash_record = pdo_fetchall($mc_cash_record_sql, array("\72\165\x6e\x69\141\x63\151\144" => $_W["\165\x6e\x69\x61\143\x69\x64"], "\x3a\164\151\x6d\x65" => $property_time), "\x75\x69\144"); goto vUj35; Duhxp: HIexo: goto ebk9l; o6SUa: $hCr4j = !($type == "\x63\x61\x73\x68\137\164\151\x6d\145"); goto Gzw1p; HAtZV: $uids = implode("\54", $mc_uids); goto PtelY; ze9K1: if ($bIQWN) { goto HIexo; } goto BlE4C; VEl5Q: $mc_uids = array_keys($mc_members); goto umi68; YLQon: $GkWFY = empty($mc_uids); goto Kx51g; WNTu5: $member = $type == "\157\x70\145\x6e\x69\144\163" ? $members : array_keys($members); goto AKIdh; O1pIY: $mc_members = pdo_getall("\155\x63\x5f\x6d\145\155\142\145\162\163", array("\165\156\x69\141\x63\x69\144" => $_W["\165\156\151\x61\143\x69\144"], "\143\x72\x65\x61\164\x65\x74\151\x6d\145\40\76" => $property_time), array("\165\x69\x64"), "\x75\x69\144"); goto UyDK3; gqQzK: if ($GkWFY) { goto Y39Xt; } goto OGxzi; zybDj: $mc_cash_record = pdo_fetchall($mc_cash_record_sql, array("\x3a\165\x69\144\x73" => $uids, "\x3a\164\x69\x6d\145" => $property_time)); goto tYyL0; z8USq: goto f4lmn; goto HiOwI; tYyL0: $sapcK = empty($mc_cash_record); goto KJlaQ; Ps840: $mc_members = pdo_getall("\155\143\137\155\145\x6d\142\x65\x72\x73", array("\x67\162\x6f\x75\160\151\144" => $param["\x67\x72\x6f\165\160\151\144"], "\x75\156\151\x61\x63\151\144" => $_W["\x75\156\151\141\x63\151\144"]), array("\x75\x69\x64"), "\165\151\144"); goto VEl5Q; Gzw1p: if ($hCr4j) { goto Gm8vE; } goto kzotq; AQA2l: $bIQWN = !empty($param); goto ze9K1; KJlaQ: if ($sapcK) { goto kFwnp; } goto adqhl; kVQ4X: An7AD: goto vApgK; aKfGU: $members = pdo_getall("\155\x63\137\x6d\x61\160\x70\151\156\x67\137\x66\x61\x6e\x73", array("\157\x70\x65\156\151\x64\x20\41\x3d" => '', "\x75\151\x64" => $mc_uids), array("\x6f\x70\x65\x6e\151\x64"), "\x6f\160\x65\156\x69\x64"); goto Au15R; gWyOl: $types = array("\156\145\x77\137\155\145\155\142\145\x72", "\157\x6c\x64\137\155\145\155\x62\145\x72", "\161\165\151\145\164\137\155\x65\155\142\x65\x72", "\141\143\164\151\166\151\164\171\137\155\x65\x6d\142\x65\162", "\x67\162\x6f\165\160\137\155\x65\x6d\142\145\x72", "\x63\x61\x73\150\x5f\164\151\x6d\145", "\x6f\x70\145\156\151\x64\x73"); goto P3HrK; vPDVp: if ($BpPFg) { goto aMB4r; } goto U_DXX; UyDK3: $mc_uids = array_keys($mc_members); goto HAtZV; sNyUu: f4lmn: goto o8_rW; I2anM: $members = pdo_getall("\x6d\143\137\x6d\x61\x70\160\x69\156\147\137\x66\x61\x6e\163", array("\165\156\x69\141\143\x69\x64" => $_W["\165\156\151\x61\143\151\x64"]), array(), "\x6f\x70\145\x6e\151\x64"); goto uRwEe; NiBEd: $mc_members = pdo_getall("\x6d\143\x5f\x6d\x65\x6d\x62\145\162\x73", array("\x75\x6e\151\x61\143\x69\x64" => $_W["\165\x6e\x69\141\x63\151\x64"], "\143\x72\145\141\x74\145\164\151\x6d\x65\x20\74" => $property_time), array("\x75\x69\144"), "\x75\151\144"); goto jPodi; xeHnr: $DfY62 = !($type == "\156\x65\x77\x5f\155\145\155\142\145\x72"); goto lcGsA; PtelY: $mc_cash_record_sql = "\123\105\x4c\105\103\x54\x20\165\x69\144\x20\x46\122\117\115\40" . tablename("\x6d\143\x5f\x63\141\x73\x68\x5f\162\x65\143\x6f\x72\x64") . "\40\127\110\x45\x52\x45\40\165\151\144\x20\x49\x4e\x20\50\40\72\x75\151\144\x73\x20\x29\x20\x41\x4e\104\40\x63\x72\145\x61\164\x65\164\x69\155\x65\x20\x3e\x20\x3a\164\151\x6d\x65\40\x47\122\117\125\x50\x20\102\131\40\165\x69\144\40\110\x41\x56\x49\116\107\x20\x43\117\125\116\124\x28\x2a\51\x20\x3c\x20\x32\40"; goto zybDj; Kx51g: if ($GkWFY) { goto XnfXD; } goto QJHma; HiOwI: bExDN: goto I2anM; FWZIu: kFwnp: goto nnmAu; TcnDT: if ($yrvwM) { goto zuPf6; } goto AQA2l; LF0XB: AeVM5: goto u0yoh; WsWvl: if (is_array($members)) { goto wXUBD; } goto RgP8O; I49Lq: $zS_4y = empty($member); goto txyxQ; hIYdT: $UtIf2 = !($type == "\x71\165\151\x65\164\137\155\145\x6d\142\145\162"); goto ZQN4P; BX9ky: KpH4N: goto lJbb7; Rm9Df: if ($GkWFY) { goto XI_mW; } goto aKfGU; u0yoh: return $members; goto QJf84; qQZ8_: gIC_q: goto KKImA; ztBo3: if ($zEJEE) { goto gIC_q; } goto c5R1n; NAIUI: $members["\164\x6f\164\141\x6c"] = count($members["\155\x65\155\142\145\x72\x73"]); goto LF0XB; vApgK: $yrvwM = !($type == "\147\x72\x6f\165\x70\137\155\145\x6d\x62\x65\x72"); goto TcnDT; FAh7D: $g7BPR = !($type == "\141\143\x74\151\x76\151\164\x79\137\155\145\x6d\x62\145\x72"); goto bKYDJ; U_DXX: $members = json_decode($_COOKIE["\146\141\x6e\163\x5f\x6f\x70\x65\x6e\x69\144\x73" . $_W["\165\156\x69\141\x63\151\x64"]]); goto GeReA; BPApi: goto AeVM5; goto tsMa9; Z8MA0: $BpPFg = !($type == "\157\160\145\156\151\144\163"); goto vPDVp; s_0X7: svVXn: goto FAh7D; UWpxy: $property_time = strtotime("\x2d" . $propertys["\x6f\154\144\155\x65\155\x62\x65\162"] . "\x20\155\x6f\x6e\x74\x68", time()); goto NiBEd; LWCf3: $property_time = strtotime("\x2d" . $propertys["\x61\143\164\151\x76\151\x74\171\x6d\x65\x6d\142\145\162"] . "\40\x6d\x6f\156\164\x68", time()); goto ZYJMx; QJHma: $members = pdo_getall("\155\x63\x5f\x6d\x61\x70\160\151\x6e\147\x5f\x66\141\156\163", array("\x75\x69\x64" => $mc_uids, "\x6f\160\145\156\x69\x64\x20\41\x3d" => ''), array("\157\x70\145\x6e\x69\x64"), "\x6f\160\145\x6e\151\144"); goto xSuR9; adqhl: foreach ($mc_cash_record as $v) { goto uZLHM; uZLHM: $rph1e = in_array($v["\165\151\144"], $mc_uids); goto zldfl; ykLYf: Uv49P: goto JCCOv; zldfl: if ($rph1e) { goto Uv49P; } goto Kvs4F; JCCOv: LyqSf: goto cUbd4; Kvs4F: unset($mc_uids[$v["\x75\x69\x64"]]); goto ykLYf; cUbd4: } goto ij0IU; GeReA: aMB4r: goto WsWvl; syBI5: $mc_uids = array_keys($mc_cash_record); goto AEoSb; Au15R: XI_mW: goto z8USq; vUj35: $mc_uids = array_keys($mc_cash_record); goto m7bRR; ssNvc: Gm8vE: goto Z8MA0; QJf84: } goto Ugtsg; fGluX: function activity_user_get_coupon($id, $openid, $granttype = 1) { goto TfFNI; N955K: $openid = $_W["\x6f\160\145\156\151\144"]; goto EKGcn; mYUdA: $fan = mc_fansinfo($openid, '', $_W["\165\156\151\x61\143\151\144"]); goto cQHEx; TP0BS: vPWXJ: goto XCjuV; G6adj: gsVL9: goto mYUdA; TN3TH: goto gyi0V; goto YVKzU; UMkfM: $insert["\143\x61\x72\144\x5f\x69\x64"] = $coupon["\x63\141\x72\x64\137\x69\x64"]; goto Bzp4m; lqSu6: if ($bn5sp) { goto Ix3sM; } goto OyVNa; YVKzU: IF4hT: goto Aiomg; qGd1i: return error(-1, "\345\x85\221\346\215\242\xe5\xa4\xb1\350\xb4\xa5"); goto r8O0B; EKGcn: $bn5sp = !empty($openid); goto qH1Vq; uAcOj: $pcount = pdo_fetchcolumn("\x53\x45\x4c\105\103\x54\x20\143\157\165\x6e\164\x28\52\51\40\x46\122\117\115\x20" . tablename("\163\164\x6f\x72\145\x78\137\143\x6f\165\160\157\x6e\x5f\162\x65\x63\x6f\162\x64") . "\x20\127\x48\x45\x52\105\40\x60\157\x70\145\156\151\x64\140\40\x3d\x20\x3a\x6f\x70\x65\x6e\151\x64\40\x41\x4e\104\40\x60\x63\x6f\x75\160\x6f\x6e\x69\144\140\x20\x3d\x20\72\x63\x6f\x75\160\x6f\156\151\x64", array("\x3a\143\x6f\x75\x70\157\156\151\x64" => $id, "\72\157\160\x65\156\151\144" => $openid)); goto rKgqk; RYsdr: $DSmks = !($granttype == 1); goto SpwEC; xt5wD: if ($YFW2G) { goto KhRHE; } goto UMkfM; suI2o: return error(-1, "\346\xb4\273\345\x8a\250\345\xb7\262\xe7\xbb\223\xe6\x9d\x9f"); goto TN3TH; Hhgao: $coupon = activity_get_coupon_info($id); goto uAcOj; cFLCa: $insert["\x63\157\144\x65"] = ''; goto ZW_Cx; Z1H0X: goto gyi0V; goto r7xNO; rKgqk: if (empty($coupon)) { goto RSTRG; } goto EglfK; U7W14: KgOWp: goto V8T8Z; SpwEC: if ($DSmks) { goto LM8jC; } goto qs8uG; BO7CL: if ($bn5sp) { goto gsVL9; } goto N955K; xwr6I: if ($pcount >= $coupon["\147\x65\164\137\154\x69\155\x69\x74"] && !empty($coupon["\147\x65\x74\x5f\x6c\151\155\x69\x74"])) { goto vPWXJ; } goto s0GC1; XCjuV: return error(-1, "\351\242\206\xe5\217\226\346\xac\241\346\x95\260\xe4\270\215\xe8\266\263\41"); goto RJbik; ZXubi: $insert["\162\x65\155\x61\x72\153"] = $give ? "\347\263\273\347\273\x9f\350\265\240\xe9\x80\201" : "\347\x94\xa8\346\x88\267\344\275\xbf\347\x94\250" . $exchange["\x63\162\x65\144\151\x74"] . $credit_names[$exchange["\143\x72\145\144\x69\x74\164\171\x70\145"]] . "\xe5\205\x91\xe6\215\xa2"; goto idfoa; ct59w: VJ3gk: goto CjmmK; Be7pU: $insert["\162\145\x6d\141\x72\x6b"] = "\xe7\xb3\xbb\347\xbb\237\xe6\xb4\xbe\345\x8f\x91"; goto ct59w; H7pp6: Ix3sM: goto G6adj; ZW_Cx: z3ZW8: goto E_Mqd; Tejzu: goto VJ3gk; goto qZ_7K; nWc5R: pdo_insert("\163\x74\157\162\145\x78\x5f\143\157\x75\160\157\x6e\137\x72\x65\x63\157\x72\x64", $insert); goto ICYRn; Sd5PK: $bn5sp = !empty($openid); goto BO7CL; OyVNa: return error(-1, "\xe6\xb2\xa1\xe6\234\211\xe6\x89\xbe\345\210\260\xe6\214\x87\xe5\xae\232\xe4\274\232\xe5\221\x98"); goto H7pp6; cQHEx: $openid = $fan["\157\x70\145\x6e\x69\144"]; goto VZF3e; gBugW: $bn5sp = !empty($openid); goto lqSu6; RJbik: gyi0V: goto fDrFv; fDrFv: $give = $_W["\x61\143\x74\151\166\x69\x74\171\137\143\x6f\165\x70\x6f\156\137\x69\144"] ? true : false; goto siRdK; r7xNO: n6Ydq: goto suI2o; styfW: hkftC: goto txGye; dPdD8: goto gyi0V; goto X1ZUL; V8T8Z: $insert["\162\x65\x6d\x61\162\153"] = "\346\211\253\347\xa0\x81\350\x8e\267\xe5\x8f\x96"; goto Tejzu; X4T5W: if ($granttype == 1) { goto hkftC; } goto scEy_; haNEV: $insert = array("\x63\157\165\x70\x6f\x6e\151\x64" => $id, "\165\151\x64" => $uid, "\165\156\x69\x61\143\x69\x64" => $_W["\165\x6e\151\141\143\151\x64"], "\157\x70\145\x6e\151\x64" => $fan["\157\160\145\156\151\x64"], "\143\157\x64\x65" => $code, "\147\x72\x61\156\x74\155\x6f\x64\x75\154\x65" => $give ? $_W["\141\143\x74\x69\x76\x69\x74\171\137\143\157\x75\x70\157\x6e\x5f\x69\144"] : $_W["\x63\x75\x72\x72\x65\156\x74\137\155\x6f\144\x75\154\x65"]["\156\x61\155\145"], "\x61\144\x64\x74\151\155\145" => TIMESTAMP, "\x73\164\141\164\x75\163" => 1, "\x67\162\141\156\x74\164\171\160\145" => $granttype); goto X4T5W; s0GC1: goto gyi0V; goto Y616C; F75Lx: if ($coupon["\161\165\141\x6e\164\x69\x74\171"] <= 0) { goto T8KML; } goto xwr6I; EglfK: if (strtotime(str_replace("\56", "\55", $coupon["\144\141\164\145\137\x69\156\146\157"]["\164\151\x6d\145\x5f\x6c\151\155\151\x74\x5f\145\x6e\144"])) < strtotime(date("\131\x2d\155\55\144")) && $coupon["\144\x61\x74\x65\137\x69\156\146\x6f"]["\x74\x69\155\145\x5f\x74\171\x70\145"] != 2) { goto n6Ydq; } goto wdyx6; C2caD: LM8jC: goto g8g19; LyV1z: $insert["\143\x61\162\144\137\x69\144"] = $coupon["\x63\x61\x72\144\x5f\x69\x64"]; goto cFLCa; r8O0B: XnLr3: goto MLSZR; tyZb5: $credit_names = array("\143\162\145\x64\x69\x74\61" => "\347\xa7\257\345\x88\206", "\x63\162\145\x64\x69\164\x32" => "\344\275\x99\351\242\x9d"); goto Hhgao; VZF3e: $bn5sp = !empty($openid); goto ttu9i; txGye: $exchange = pdo_get("\163\x74\157\x72\x65\x78\137\x61\143\164\x69\166\151\164\x79\137\x65\x78\143\x68\x61\x6e\x67\x65", array("\x75\x6e\151\x61\x63\x69\x64" => $_W["\165\x6e\151\x61\143\151\144"], "\x65\170\164\162\x61" => $id), array()); goto ZXubi; uq3mZ: pdo_update("\163\164\157\162\x65\170\137\143\x6f\165\160\x6f\x6e", array("\161\x75\141\x6e\164\151\164\x79" => $coupon["\161\165\141\x6e\164\151\164\x79"] - 1, "\144\157\x73\141\x67\145" => $coupon["\144\x6f\163\141\147\145"] + 1), array("\165\156\x69\x61\x63\151\144" => $_W["\165\x6e\x69\x61\x63\151\144"], "\151\x64" => $coupon["\x69\x64"])); goto RYsdr; nCHw3: return error(-1, "\xe5\x8d\241\345\x88\270\xe5\217\x91\346\x94\xbe\345\256\214\346\257\x95"); goto ULTeN; qH1Vq: if ($bn5sp) { goto yOw84; } goto KMkd5; Y616C: RSTRG: goto twzEI; Aiomg: return error(-1, "\346\264\xbb\xe5\212\250\346\234\252\345\xbc\200\345\xa7\213"); goto dPdD8; hBA4M: yOw84: goto gBugW; X1ZUL: T8KML: goto nCHw3; TfFNI: global $_W, $_GPC; goto Sd5PK; idfoa: goto VJ3gk; goto U7W14; P62wu: if ($d3PT3) { goto z3ZW8; } goto LyV1z; scEy_: if ($granttype == 2) { goto KgOWp; } goto Kt45d; siRdK: $uid = !empty($_W["\x6d\145\155\142\x65\162"]["\165\151\x64"]) ? $_W["\155\x65\155\142\x65\162"]["\165\151\144"] : $fan["\165\151\144"]; goto haNEV; ULTeN: goto gyi0V; goto TP0BS; MLSZR: $code = base_convert(md5(uniqid() . random(4)), 16, 10); goto el_UL; g8g19: return $insert_id; goto MqNtx; Kt45d: if ($granttype == 3) { goto scW16; } goto CkgZe; CjmmK: $d3PT3 = !($coupon["\163\x6f\165\x72\143\145"] == 2); goto P62wu; Bzp4m: KhRHE: goto nWc5R; twzEI: return error(-1, "\346\234\252\346\211\xbe\xe5\x88\260\xe6\214\207\345\xae\232\xe5\215\241\xe5\210\xb8"); goto Z1H0X; JJIG8: $user = mc_fetch($fan["\x75\151\x64"], array("\147\162\157\165\160\151\x64")); goto tyZb5; CkgZe: goto VJ3gk; goto styfW; E_Mqd: $YFW2G = !empty($insert["\143\141\x72\x64\x5f\x69\144"]); goto xt5wD; qs8uG: pdo_update("\x73\164\x6f\162\145\170\x5f\141\143\x74\x69\x76\151\x74\171\x5f\145\x78\143\150\141\156\x67\145", array("\x6e\x75\155" => $exchange["\x6e\165\155"] + 1), array("\151\x64" => $exchange["\151\x64"])); goto C2caD; KMkd5: $openid = $_W["\x6d\x65\x6d\x62\x65\x72"]["\x75\151\x64"]; goto hBA4M; ttu9i: if ($bn5sp) { goto XnLr3; } goto qGd1i; ICYRn: $insert_id = pdo_insertid(); goto uq3mZ; el_UL: $code = substr($code, 1, 16); goto JJIG8; qZ_7K: scW16: goto Be7pU; wdyx6: if (strtotime(str_replace("\x2e", "\x2d", $coupon["\x64\141\x74\x65\137\151\x6e\146\x6f"]["\164\151\155\x65\x5f\154\x69\155\x69\164\x5f\x73\164\x61\x72\x74"])) > strtotime(date("\x59\55\155\55\x64")) && $coupon["\x64\x61\164\x65\137\151\156\146\157"]["\164\151\155\x65\137\x74\171\x70\x65"] != 2) { goto IF4hT; } goto F75Lx; MqNtx: } goto P_OYY; cG8nY: function activity_get_coupon_type() { goto g4aiX; g4aiX: global $_W; goto gTL76; gTL76: $setting = pdo_get("\163\x74\157\x72\145\x78\x5f\x73\145\x74", array("\x77\145\x69\x64" => $_W["\165\156\x69\x61\143\x69\x64"]), "\163\x6f\165\162\x63\145"); goto EklTk; dEb3c: define("\x43\x4f\x55\120\117\116\x5f\124\131\120\105", WECHAT_COUPON); goto Ea_pa; SO3Cx: EhjM4: goto jMjIQ; EklTk: if ($setting["\x73\157\x75\x72\x63\x65"] == 1) { goto gIn8H; } goto dEb3c; Ea_pa: goto EhjM4; goto ubEp7; ubEp7: gIn8H: goto TdWyt; TdWyt: define("\x43\x4f\x55\x50\117\116\x5f\x54\x59\x50\x45", SYSTEM_COUPON); goto SO3Cx; jMjIQ: } goto V8LTS; iDvhs: function activity_get_coupon_info($id) { goto p1VyS; Wemo2: $gny7a = empty($coupon_stores); goto nn16M; nn16M: if ($gny7a) { goto fvm7i; } goto ZgFUF; d1hCX: $coupon["\154\157\x67\157\137\165\x72\x6c"] = tomedia($coupon["\x6c\157\147\x6f\137\x75\162\154"]); goto dwEWY; n1DP3: $coupon["\x65\170\164\x72\141\x5f\x64\x61\164\145\x5f\x69\x6e\x66\157"] = "\346\234\x89\346\x95\x88\346\234\237\72" . $coupon["\144\141\x74\145\x5f\151\x6e\146\157"]["\x74\x69\x6d\x65\137\x6c\151\155\151\x74\x5f\x73\x74\x61\162\x74"] . "\x2d" . $coupon["\144\x61\x74\x65\137\x69\x6e\x66\x6f"]["\x74\151\155\x65\x5f\154\x69\155\151\164\x5f\x65\156\x64"]; goto KiYwa; IglQM: if ($x7k4J) { goto rOsEo; } goto VBFfU; qRpYR: goto VSTSx; goto KmUXB; dwEWY: $coupon["\144\x65\x73\143\162\x69\160\x74\151\x6f\x6e"] = htmlspecialchars_decode($coupon["\144\145\x73\x63\162\151\160\164\151\157\x6e"]); goto UpDRB; KmUXB: D8ozc: goto n1DP3; UChQs: $x7k4J = !empty($coupon); goto IglQM; xNCp7: $coupon = pdo_get("\x73\164\157\162\x65\x78\137\143\157\165\x70\157\x6e", array("\165\156\x69\x61\x63\151\x64" => $_W["\165\x6e\x69\141\143\151\x64"], "\151\x64" => $id)); goto UChQs; nRl1Y: $id = intval($id); goto xNCp7; ui2v5: $coupon["\145\170\x74\162\x61"] = iunserializer($coupon["\145\170\x74\162\x61"]); goto d1hCX; VBFfU: return error(1, "\345\x8d\241\345\x88\270\344\xb8\x8d\345\255\x98\345\x9c\xa8\xe6\210\x96\xe6\230\xaf\345\xb7\262\347\xbb\x8f\350\xa2\xab\345\x88\240\351\x99\xa4"); goto u1klH; hjU0O: $coupon["\145\x78\164\162\x61\x5f\x64\x61\164\x65\137\151\156\x66\x6f"] = "\346\234\211\xe6\x95\210\xe6\234\x9f\72\xe9\xa2\206\xe5\x8f\226\345\x90\216" . ($coupon["\144\141\x74\145\137\151\156\x66\157"]["\144\145\x61\144\154\151\x6e\145"] == 0 ? "\345\275\x93" : $coupon["\144\141\164\x65\137\151\156\x66\x6f"]["\x64\x65\x61\x64\154\x69\x6e\145"]) . "\xe5\xa4\251\xe5\x8f\257\347\x94\xa8\xef\274\x8c\xe6\x9c\211\xe6\225\x88\346\x9c\x9f" . $coupon["\x64\x61\x74\x65\x5f\151\156\146\157"]["\x6c\151\155\151\164"] . "\345\244\251"; goto qRpYR; p1VyS: global $_W; goto nRl1Y; bx_Dj: fvm7i: goto UfSHt; plrdx: if ($coupon["\144\x61\x74\145\137\x69\x6e\146\x6f"]["\164\x69\155\145\137\x74\x79\x70\145"] == "\61") { goto D8ozc; } goto hjU0O; M7eFp: $coupon["\154\x6f\143\141\164\151\157\x6e\137\x69\x64\x5f\x6c\x69\x73\x74"] = $stores; goto bx_Dj; UwET4: $coupon["\x64\141\x74\x65\137\x69\x6e\x66\x6f"] = iunserializer($coupon["\144\x61\164\x65\137\x69\156\146\157"]); goto plrdx; UfSHt: return $coupon; goto UM_v_; ZgFUF: $stores = pdo_getall("\163\x74\157\162\145\x78\137\x62\x61\x73\145\163", array("\151\x64" => array_keys($coupon_stores)), array("\x74\x69\x74\x6c\145", "\x69\x64"), "\151\x64"); goto M7eFp; KiYwa: VSTSx: goto ui2v5; u1klH: rOsEo: goto UwET4; UpDRB: $coupon_stores = pdo_getall("\x73\164\157\x72\x65\170\x5f\x63\157\165\x70\x6f\x6e\x5f\x73\x74\x6f\x72\145", array("\x75\156\x69\141\x63\151\x64" => $_W["\165\156\151\x61\x63\151\x64"], "\143\x6f\165\160\x6f\x6e\x69\x64" => $coupon["\x69\x64"]), array(), "\x73\164\157\162\x65\x69\x64"); goto Wemo2; UM_v_: } goto fGluX; UhjpY: function storex_account_change_operator($clerk_type, $store_id, $clerk_id) { goto QP3D1; k1Otp: if ($clerk_type == 2) { goto Kz_S3; } goto AU8W8; OBnGf: goto Ccfz0; goto a_Nua; ZuXMB: return $data; goto Robto; D8i21: if ($Y1KLY) { goto xIW7a; } goto mVXcD; qonnM: if (empty($clerk_id)) { goto d7_t1; } goto Lkb3N; DwK1q: $data = array("\143\154\145\162\153\137\143\x6e" => '', "\163\x74\157\162\x65\137\143\x6e" => ''); goto hW936; GNfrR: xIW7a: goto ZuXMB; Dhmdc: $stores = pdo_getall("\x73\x74\157\x72\x65\x78\137\x61\143\x74\151\166\151\164\171\x5f\163\164\x6f\x72\145\163", array("\165\x6e\x69\141\x63\151\x64" => $_W["\165\x6e\151\141\143\151\x64"]), array("\x69\x64", "\142\165\x73\151\x6e\x65\x73\x73\x5f\156\141\155\x65", "\x62\162\x61\x6e\x63\x68\x5f\x6e\141\x6d\145"), "\151\x64"); goto pa1RC; s7CKq: goto SUikq; goto NAf1g; U2SKY: $data["\x73\164\157\162\x65\x5f\x63\x6e"] = $stores[$store_id]["\142\x75\163\151\x6e\145\x73\x73\137\x6e\141\155\x65"] . "\40" . $stores[$store_id]["\x62\x72\x61\x6e\x63\x68\137\156\x61\155\x65"]; goto oIo2s; DWXDU: $data["\x63\154\145\x72\153\x5f\143\156"] = "\xe7\xb3\xbb\xe7\273\237"; goto xl0Gz; tYobp: zAUSx: goto rvp7k; oiHZ7: UhPOb: goto DWXDU; mVXcD: $data["\143\154\x65\162\153\x5f\x63\x6e"] = "\xe6\x9a\202\346\x97\240\xe6\223\215\344\275\x9c\xe5\x91\x98\xe4\277\xa1\xe6\x81\xaf"; goto GNfrR; xl0Gz: goto Ccfz0; goto xZApD; AU8W8: if ($clerk_type == 3) { goto b3EMU; } goto sTKgQ; pa1RC: EAKIH: goto DwK1q; LHzrd: $clerks = pdo_getall("\x73\164\x6f\x72\x65\x78\137\x61\143\164\x69\166\151\x74\x79\137\143\x6c\145\162\x6b\x73", array("\165\156\151\x61\x63\151\x64" => $_W["\x75\x6e\x69\141\143\151\x64"]), array("\151\144", "\156\x61\x6d\x65"), "\x69\144"); goto Dhmdc; ncPlz: if ($at2Ie) { goto zAUSx; } goto okFLj; rvp7k: $Y1KLY = !empty($data["\143\x6c\x65\x72\153\137\143\x6e"]); goto D8i21; Yr0UX: $data["\143\154\x65\162\153\x5f\x63\156"] = "\xe6\234\254\344\272\xba\xe6\223\215\344\xbd\x9c"; goto PyJx_; hW936: if ($clerk_type == 1) { goto UhPOb; } goto k1Otp; a_Nua: b3EMU: goto qonnM; xZApD: Kz_S3: goto PxSks; Lkb3N: $data["\143\154\x65\x72\x6b\137\143\x6e"] = $clerks[$clerk_id]["\x6e\141\x6d\x65"]; goto s7CKq; okFLj: $data["\x73\164\157\x72\x65\x5f\143\x6e"] = "\346\x9a\x82\xe6\x97\240\xe9\x97\xa8\xe5\xba\227\344\277\xa1\346\x81\257"; goto tYobp; PxSks: $data["\143\x6c\x65\162\x6b\x5f\143\x6e"] = pdo_fetchcolumn("\x53\x45\114\x45\103\x54\40\x75\x73\145\x72\156\141\155\145\40\x46\122\x4f\x4d\40" . tablename("\165\x73\x65\x72\163") . "\40\127\x48\105\x52\x45\x20\x75\x69\144\x20\x3d\40\72\x75\151\x64", array("\x3a\165\x69\144" => $clerk_id)); goto OBnGf; x98x9: $CNpiI = !(empty($stores) || empty($clerks)); goto F_eq2; NAf1g: d7_t1: goto Yr0UX; F_eq2: if ($CNpiI) { goto EAKIH; } goto LHzrd; PyJx_: SUikq: goto U2SKY; oIo2s: Ccfz0: goto hT7vk; QP3D1: global $stores, $clerks, $_W; goto x98x9; hT7vk: $at2Ie = !empty($data["\163\x74\157\x72\x65\137\x63\156"]); goto ncPlz; sTKgQ: goto Ccfz0; goto oiHZ7; Robto: } goto Y_OiS; Rm6g4: function activity_storex_sync() { goto cPlD7; Dl0Ad: mjWzd: goto pF4dD; cjXSY: return true; goto gpGB2; zRtsJ: return false; goto Dl0Ad; BGekf: $cache = cache_load($cachekey); goto RJc_8; cPlD7: global $_W; goto Ab2TA; RJc_8: $gA1Kt = !(!empty($cache) && $cache["\145\170\160\151\162\145"] > time()); goto Y1PLz; CimR3: cache_write($cachekey, array("\x65\170\x70\151\x72\145" => time() + 1800)); goto cjXSY; pF4dD: $stores = pdo_getall("\x73\164\157\162\x65\170\137\x61\143\164\151\x76\x69\164\171\137\x73\164\157\x72\145\163", array("\x75\x6e\151\x61\143\x69\144" => $_W["\x75\156\x69\x61\x63\151\144"], "\163\157\x75\162\143\x65" => 2)); goto w85BT; Ab2TA: load()->classs("\x63\157\165\x70\x6f\x6e"); goto V0WcE; V0WcE: $cachekey = "\x73\164\x6f\162\x65\x78\163\x79\x6e\143\72{$_W["\x75\156\151\141\x63\x69\x64"]}"; goto BGekf; Paddv: DNS6D: goto CimR3; Y1PLz: if ($gA1Kt) { goto mjWzd; } goto zRtsJ; w85BT: foreach ($stores as $val) { goto VgXeU; uE2Sy: unset($location["\x63\141\x74\x65\147\x6f\x72\x69\x65\163"], $location["\160\x6f\x69\137\x69\144"], $location["\x75\160\144\x61\x74\x65\137\163\x74\141\164\165\x73"], $location["\x61\166\141\x69\154\x61\x62\154\x65\137\163\164\x61\164\x65"], $location["\157\146\146\163\x65\x74\x5f\164\x79\160\x65"], $location["\x73\x69\x64"], $location["\164\171\160\x65"], $location["\x71\x75\141\x6c\x69\x66\151\x63\x61\x74\151\x6f\x6e\137\154\x69\163\x74"], $location["\x75\160\147\162\141\144\145\137\x63\x6f\155\x6d\x65\156\164"], $location["\x75\x70\147\x72\x61\x64\145\137\x73\164\141\x74\165\x73"], $location["\x6d\141\160\x69\144"]); goto UII8d; XtrnF: $location["\160\150\x6f\164\157\137\x6c\151\x73\164"] = iserializer($location["\160\x68\x6f\164\157\x5f\x6c\151\x73\x74"]); goto uE2Sy; Tjlgq: $acc = new coupon($_W["\x61\143\151\x64"]); goto UPl6Y; AHjpF: goto W8Vgy; goto cTGAS; Q8uTE: $status2local = array('', 3, 2, 1, 3); goto uniOg; VgXeU: $RhUAn = !($val["\x73\x74\141\164\x75\163"] == 3); goto UXvTX; UXvTX: if ($RhUAn) { goto I4DS7; } goto AHjpF; hMRd1: $location["\143\141\x74\x65\x67\x6f\162\171"] = iserializer(array("\143\141\164\145" => $category_temp[0], "\x73\165\x62" => $category_temp[1], "\143\x6c\x61\x73" => $category_temp[2])); goto XtrnF; Z5oyf: BnyP5: goto Us3yw; CUGna: W8Vgy: goto KpL21; UII8d: pdo_update("\x73\x74\157\x72\145\170\137\x61\x63\x74\x69\166\151\x74\x79\137\x73\164\x6f\162\x65\x73", $location, array("\165\x6e\x69\141\x63\151\x64" => $_W["\x75\x6e\x69\x61\143\151\x64"], "\x69\x64" => $val["\151\x64"])); goto CUGna; F1Ngr: return error(-1, $location["\x6d\x65\x73\x73\x61\x67\145"]); goto Z5oyf; UPl6Y: $location = $acc->LocationGet($val["\x6c\x6f\x63\141\164\151\157\x6e\137\151\x64"]); goto bQI01; Us3yw: $location = $location["\142\165\x73\151\x6e\x65\x73\x73"]["\142\x61\x73\x65\x5f\x69\156\146\x6f"]; goto Q8uTE; kQeOm: $category_temp = explode("\54", $location["\x63\141\164\145\x67\x6f\162\151\145\163"][0]); goto hMRd1; bQI01: $J7HsM = !is_error($location); goto PQEUd; uniOg: $location["\x73\164\x61\x74\x75\163"] = $status2local[$location["\x61\x76\141\x69\154\x61\x62\154\145\x5f\163\164\x61\x74\x65"]]; goto Pbb83; Pbb83: $location["\154\157\x63\x61\164\151\157\156\137\x69\144"] = $location["\160\157\x69\x5f\151\x64"]; goto kQeOm; cTGAS: I4DS7: goto Tjlgq; PQEUd: if ($J7HsM) { goto BnyP5; } goto F1Ngr; KpL21: } goto Paddv; gpGB2: } goto UhjpY; zgnOe: function activity_user_get_goods($uid, $exid) { goto q6Zmt; EFcGg: return error(-1, "\350\xaf\xa5\xe5\xae\x9e\xe7\211\xa9\345\205\221\xe6\215\242\xe5\xb7\xb2\345\205\x91\xe6\215\xa2\345\256\214"); goto nj6L6; q6Zmt: global $_W; goto qfqob; bT0IK: if ($HxTFt) { goto oHdy6; } goto BIETX; TAXwZ: $dvZM0 = !($exchange["\x65\156\144\x74\151\155\x65"] < TIMESTAMP); goto B8ETe; zrtIA: F2S4x: goto JUuTc; qodYS: $vIfBj = !empty($insert_id); goto WOwUP; qfqob: $exid = intval($exid); goto FYr2N; gTr9t: return error(-1, "\345\xae\236\xe7\211\251\345\205\221\346\215\xa2\345\244\261\xe8\xb4\245"); goto zrtIA; WOwUP: if ($vIfBj) { goto F2S4x; } goto gTr9t; BIETX: return error(-1, "\xe6\262\241\xe6\x9c\x89\346\x8c\207\345\xae\x9a\xe7\232\x84\345\xae\236\xe7\211\xa9\xe5\205\221\346\215\xa2"); goto kFqmD; Dtfgy: pdo_insert("\x73\164\x6f\x72\x65\x78\x5f\141\143\164\x69\166\151\x74\171\x5f\145\x78\143\150\141\x6e\147\145\137\x74\162\x61\144\145\163\x5f\163\x68\151\x70\160\x69\156\x67", $insert); goto mgHzX; FYr2N: $uid = intval($uid); goto X865N; WWWOS: pdo_insert("\163\x74\157\x72\x65\x78\137\141\x63\164\151\x76\x69\164\171\137\x65\170\x63\150\141\156\147\145\x5f\x74\162\141\144\x65\163", $data); goto OywDM; SRFC5: $data = array("\165\156\x69\x61\x63\x69\144" => $_W["\165\156\151\141\x63\x69\144"], "\x75\151\144" => $uid, "\x74\x79\x70\x65" => 3, "\145\x78\151\x64" => $exid, "\143\x72\145\x61\x74\x65\x74\151\x6d\145" => TIMESTAMP); goto WWWOS; VA3ON: if ($df9OV) { goto RQ2dW; } goto EFcGg; nj6L6: RQ2dW: goto SRFC5; AHzcW: if ($aUNzy) { goto a0LmX; } goto yQaHb; lcjtG: return $insert_id; goto zP022; O4lGX: fZO4K: goto TAXwZ; UqqPv: $aUNzy = !($pnum >= $exchange["\x70\x72\x65\164\157\164\x61\154"]); goto AHzcW; T10CX: t_L0X: goto SVo1i; kFqmD: oHdy6: goto XWvci; SVo1i: $pnum = pdo_fetchcolumn("\123\x45\x4c\105\x43\124\40\103\117\125\116\124\50\52\x29\x20\106\122\x4f\115\40" . tablename("\x73\x74\x6f\162\x65\170\137\141\143\164\151\166\x69\164\x79\137\145\x78\143\150\141\156\x67\x65\137\164\162\141\144\x65\163") . "\x20\x57\110\105\x52\x45\x20\165\156\151\141\143\x69\x64\x20\x3d\x20\x3a\x75\x6e\151\x61\x63\151\x64\x20\101\116\104\40\x75\151\144\x20\x3d\x20\x3a\x75\151\x64\x20\101\x4e\104\x20\x65\170\151\144\40\x3d\x20\x3a\x65\170\151\144", array("\72\x75\156\151\x61\x63\x69\x64" => $_W["\x75\x6e\x69\x61\143\x69\x64"], "\72\x75\x69\144" => $uid, "\x3a\145\x78\x69\144" => $exid)); goto UqqPv; JUuTc: $insert = array("\x74\151\x64" => $insert_id, "\x75\156\151\141\143\x69\x64" => $_W["\165\x6e\x69\141\143\x69\144"], "\165\x69\x64" => $uid, "\163\164\x61\164\165\x73" => 0, "\145\x78\x69\x64" => $exid, "\143\x72\145\x61\x74\x65\164\x69\x6d\x65" => TIMESTAMP); goto Dtfgy; yGk2c: a0LmX: goto uRUSc; CAfBW: return error(-1, "\350\257\xa5\345\xae\x9e\347\211\xa9\345\x85\x91\xe6\x8d\xa2\xe5\xb7\262\347\xbb\217\xe7\xbb\x93\346\x9d\237"); goto T10CX; B8ETe: if ($dvZM0) { goto t_L0X; } goto CAfBW; OywDM: $insert_id = pdo_insertid(); goto qodYS; X865N: $exchange = activity_get_exchange_info($exid, $_W["\165\156\151\141\x63\151\144"]); goto MDawI; uRUSc: $df9OV = !($exchange["\156\x75\155"] >= $exchange["\164\x6f\164\x61\154"]); goto VA3ON; slUPS: return error(-1, "\xe8\xaf\xa5\xe5\256\236\xe7\211\251\xe5\x85\221\xe6\x8d\242\xe5\xb0\x9a\346\234\xaa\345\xbc\x80\345\xa7\x8b"); goto O4lGX; yQaHb: return error(-1, "\350\257\245\345\256\236\347\x89\251\xe5\205\x91\346\215\xa2\xe6\257\x8f\xe4\272\xba\345\217\xaa\xe8\x83\275\xe4\275\277\xe7\x94\250" . $exchange["\160\x72\x65\164\157\x74\x61\x6c"] . "\xe6\254\xa1"); goto yGk2c; XWvci: $FYCJD = !($exchange["\x73\x74\x61\162\x74\x74\x69\155\x65"] > TIMESTAMP); goto wsBAf; mgHzX: pdo_update("\163\x74\x6f\x72\145\170\x5f\x61\x63\x74\151\x76\151\164\171\x5f\x65\170\143\150\141\156\147\145", array("\x6e\x75\x6d" => $exchange["\156\165\x6d"] + 1), array("\x69\144" => $exid, "\x75\156\x69\141\143\x69\144" => $_W["\x75\x6e\151\x61\x63\151\x64"])); goto lcjtG; wsBAf: if ($FYCJD) { goto fZO4K; } goto slUPS; MDawI: $HxTFt = !empty($exchange); goto bT0IK; zP022: }